schema: '2.0'
stages:
  download_benchmark_data:
    cmd: python src/mctm/data/benchmark.py | tee datasets/benchmark_stats
    outs:
    - path: datasets/benchmark_stats
      hash: md5
      md5: d2c8e4eeea4465d0bd5e5473f8d6a93a
      size: 9349
    - path: datasets/bsds300/
      hash: md5
      md5: e4ab795c846604419827e750c741c2ce.dir
      size: 327602144
      nfiles: 1
    - path: datasets/data.tar.gz
      hash: md5
      md5: 9b9c9b0375315ad270eba4ce80c093ab
      size: 856664546
    - path: datasets/hepmass/
      hash: md5
      md5: 5e24c498e022d4c8b79714a6065882cf.dir
      size: 750085192
      nfiles: 2
    - path: datasets/miniboone/
      hash: md5
      md5: 5cf3ec51bb664978790c9a45a3531e98.dir
      size: 12551952
      nfiles: 1
    - path: datasets/power/
      hash: md5
      md5: 885e2dbe66f0670d26e959e74be98025.dir
      size: 131154000
      nfiles: 1
  unconditional_benchmark@elementwise_flow-hepmass:
    cmd: python scripts/train_benchmark.py --log-level info --log-file results/unconditional_benchmark_elementwise_flow_hepmass/train.log
      --experiment-name unconditional-benchmark-hepmass unconditional_benchmark@elementwise_flow-hepmass
      elementwise_flow hepmass results/unconditional_benchmark_elementwise_flow_hepmass
      --test-mode=true
    deps:
    - path: datasets/hepmass
      hash: md5
      md5: 5e24c498e022d4c8b79714a6065882cf.dir
      size: 750085192
      nfiles: 2
    - path: pyproject.toml
      hash: md5
      md5: f04546362686cf891a3c1b7df83d1e0b
      size: 1104
    - path: scripts/train.py
      hash: md5
      md5: 916524801990bc4d596d19e635883808
      size: 5431
    - path: src/mctm
      hash: md5
      md5: 1c4d557c6e5dc3341f257a44a062eedb.dir
      size: 80242
      nfiles: 14
    params:
      params.yaml:
        benchmark_datasets.hepmass*: {}
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.elementwise_flow.hepmass*:
          distribution_kwds:
            bijector_name: bernstein_poly
            order: 100
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
            shift: false
            scale: false
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            validation_split:
            batch_size: 32
            lr_patience: 10
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            learning_rate: 0.01
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/mcp
      hash: md5
      md5: 0530413b431d39f8b8051900d4761a31.dir
      size: 26864
      nfiles: 3
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/metrics.yaml
      hash: md5
      md5: 4df4f4661d0b0cbac7fa985d5bfffb5c
      size: 54
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/train.log
      hash: md5
      md5: 9cbe5eef18773d7720417a63e0d6f058
      size: 3589
  unconditional_benchmark@elementwise_flow-miniboone:
    cmd: python scripts/train_benchmark.py --log-level info --log-file results/unconditional_benchmark_elementwise_flow_miniboone/train.log
      --experiment-name unconditional-benchmark-miniboone unconditional_benchmark@elementwise_flow-miniboone
      elementwise_flow miniboone results/unconditional_benchmark_elementwise_flow_miniboone
      --test-mode=true
    deps:
    - path: datasets/miniboone
      hash: md5
      md5: 5cf3ec51bb664978790c9a45a3531e98.dir
      size: 12551952
      nfiles: 1
    - path: pyproject.toml
      hash: md5
      md5: f04546362686cf891a3c1b7df83d1e0b
      size: 1104
    - path: scripts/train.py
      hash: md5
      md5: 916524801990bc4d596d19e635883808
      size: 5431
    - path: src/mctm
      hash: md5
      md5: dcfe538d7edb930e60022986f36286f5.dir
      size: 80187
      nfiles: 14
    params:
      params.yaml:
        benchmark_datasets.miniboone*: {}
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.elementwise_flow.miniboone*:
          distribution_kwds:
            bijector_name: bernstein_poly
            order: 100
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
            shift: false
            scale: false
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            validation_split:
            batch_size: 87
            lr_patience: 5
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            learning_rate: 0.006797537543994487
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/mcp
      hash: md5
      md5: e35c9fba435ba06660e0f555f1fd0c8a.dir
      size: 53273
      nfiles: 3
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/metrics.yaml
      hash: md5
      md5: 37a6d282b435782aa00176a2331b6774
      size: 52
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/train.log
      hash: md5
      md5: f08d60c51e7217ab9ab8b6850a9d5e6d
      size: 3628
  unconditional@elementwise_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@elementwise_flow-moons elementwise_flow moons
      results/unconditional_elementwise_flow_moons --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.elementwise_flow.moons*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 50
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_elementwise_flow_moons/dataset.pdf
      hash: md5
      md5: 7223e1c46047410c8ef621bc6347d4af
      size: 24850
    - path: results/unconditional_elementwise_flow_moons/mcp
      hash: md5
      md5: af447a584aedd06072b1e80ddccefc3d.dir
      size: 2483
      nfiles: 3
    - path: results/unconditional_elementwise_flow_moons/metrics.yaml
      hash: md5
      md5: fcaa9273abcca00b2301df4481129b71
      size: 54
    - path: results/unconditional_elementwise_flow_moons/samples.pdf
      hash: md5
      md5: effb6d6363d9dea11fcddce4bdea8902
      size: 106935
    - path: results/unconditional_elementwise_flow_moons/train.log
      hash: md5
      md5: b0782f2f38ccf34b8e056e410267ce49
      size: 1867
  unconditional@elementwise_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@elementwise_flow-circles elementwise_flow
      circles results/unconditional_elementwise_flow_circles --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.elementwise_flow.circles*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 80
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_elementwise_flow_circles/dataset.pdf
      hash: md5
      md5: a2c7e60c1144085e6e2773979072adbb
      size: 25008
    - path: results/unconditional_elementwise_flow_circles/mcp
      hash: md5
      md5: 36f0276419ed8c32b0db301614aa5293.dir
      size: 3203
      nfiles: 3
    - path: results/unconditional_elementwise_flow_circles/metrics.yaml
      hash: md5
      md5: f58e888dcae13af660af60d43735fede
      size: 54
    - path: results/unconditional_elementwise_flow_circles/samples.pdf
      hash: md5
      md5: 88464d062741b6aed7b8965f330ae8d6
      size: 103203
    - path: results/unconditional_elementwise_flow_circles/train.log
      hash: md5
      md5: 13173b98d4fb368c0c7419763c80b227
      size: 1896
  unconditional@multivariate_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@multivariate_flow-moons multivariate_flow
      moons results/unconditional_multivariate_flow_moons --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_flow.moons*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 50
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_multivariate_flow_moons/dataset.pdf
      hash: md5
      md5: 443f060f646ec9edf4ae852adedd36a4
      size: 24850
    - path: results/unconditional_multivariate_flow_moons/mcp
      hash: md5
      md5: 2ec3d907acda28d89d285c52d5515e72.dir
      size: 2507
      nfiles: 3
    - path: results/unconditional_multivariate_flow_moons/metrics.yaml
      hash: md5
      md5: 6632cf2abb874b293fc710e037de6e52
      size: 51
    - path: results/unconditional_multivariate_flow_moons/samples.pdf
      hash: md5
      md5: d4b07a53cca86e7508c50da0f895342a
      size: 98208
    - path: results/unconditional_multivariate_flow_moons/train.log
      hash: md5
      md5: 81b7e699711cc418fd0ec2e01a5f762b
      size: 1868
  unconditional@multivariate_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@multivariate_flow-circles multivariate_flow
      circles results/unconditional_multivariate_flow_circles --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_flow.circles*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 50
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_multivariate_flow_circles/dataset.pdf
      hash: md5
      md5: 5d7c5b4eb4d345bbae71b4c881104595
      size: 25008
    - path: results/unconditional_multivariate_flow_circles/mcp
      hash: md5
      md5: f51b41b31c28c9712e7cadb535e1d035.dir
      size: 2507
      nfiles: 3
    - path: results/unconditional_multivariate_flow_circles/metrics.yaml
      hash: md5
      md5: 82735e2363736636e0d40a2060407816
      size: 52
    - path: results/unconditional_multivariate_flow_circles/samples.pdf
      hash: md5
      md5: de1d906fc3643d0b50cdfa3e887db26c
      size: 96867
    - path: results/unconditional_multivariate_flow_circles/train.log
      hash: md5
      md5: 7139a36055f3310f9a40697b2a239dc6
      size: 1898
  unconditional@multivariate_normal-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@multivariate_normal-moons multivariate_normal
      moons results/unconditional_multivariate_normal_moons --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_normal.moons*:
          distribution_kwargs: {}
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_multivariate_normal_moons/dataset.pdf
      hash: md5
      md5: bc97d3d8f7439801a36be7d832834939
      size: 24850
    - path: results/unconditional_multivariate_normal_moons/mcp
      hash: md5
      md5: 5c1fbb0463c6f1c7d5a631cab513ae29.dir
      size: 1323
      nfiles: 3
    - path: results/unconditional_multivariate_normal_moons/metrics.yaml
      hash: md5
      md5: 37498c46ff0eae96507c7c9030f84973
      size: 53
    - path: results/unconditional_multivariate_normal_moons/samples.pdf
      hash: md5
      md5: d5b7647f804b0428fb497e82c517a649
      size: 103415
    - path: results/unconditional_multivariate_normal_moons/train.log
      hash: md5
      md5: 40803fe57beffe7d49bebd9f80d8eeb2
      size: 1828
  unconditional@multivariate_normal-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@multivariate_normal-circles multivariate_normal
      circles results/unconditional_multivariate_normal_circles --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_normal.circles*:
          distribution_kwargs: {}
          parameter_kwargs:
            conditional: false
            dtype: float32
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_multivariate_normal_circles/dataset.pdf
      hash: md5
      md5: d129fd6392e2b3e11a8e96f073267d9b
      size: 25008
    - path: results/unconditional_multivariate_normal_circles/mcp
      hash: md5
      md5: 44e09d3b9637d64b066d9c6025ac5e09.dir
      size: 1323
      nfiles: 3
    - path: results/unconditional_multivariate_normal_circles/metrics.yaml
      hash: md5
      md5: cfae1c1355f4f4f403ec923e674b3844
      size: 53
    - path: results/unconditional_multivariate_normal_circles/samples.pdf
      hash: md5
      md5: b064f10dcd6cb0a794b7f25e1674cbb7
      size: 100020
    - path: results/unconditional_multivariate_normal_circles/train.log
      hash: md5
      md5: 567ab399958d6460bb308a20775aef73
      size: 1857
  unconditional@coupling_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@coupling_flow-moons coupling_flow moons results/unconditional_coupling_flow_moons
      --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.coupling_flow.moons*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            num_layers: 1
            order: 50
          parameter_kwargs:
            hidden_units:
            - 16
            - 16
            - 16
            activation: tanh
            batch_norm: false
            dropout: 0
          fit_kwargs:
            epochs: 110
            batch_size: 256
            learning_rate:
              scheduler_name: polynomial_decay
              scheduler_kwargs:
                initial_learning_rate: 0.01
                end_learning_rate: 1e-05
                power: 1
                decay_steps: 100
            validation_split: 0.1
            lr_patience: 1
            reduce_lr_on_plateau: false
            early_stopping: 50
            monitor: val_loss
            verbose: true
    outs:
    - path: results/unconditional_coupling_flow_moons/dataset.pdf
      hash: md5
      md5: b278c3d8f9a418972b909193654e7a4c
      size: 24850
    - path: results/unconditional_coupling_flow_moons/mcp
      hash: md5
      md5: a21a961a8c3f5c7d8c2825b5f3315e9f.dir
      size: 703
      nfiles: 3
    - path: results/unconditional_coupling_flow_moons/metrics.yaml
      hash: md5
      md5: 69543911ed29dd66055eecf1c568721a
      size: 53
    - path: results/unconditional_coupling_flow_moons/samples.pdf
      hash: md5
      md5: 03b04e5a451d6a067b288f6bf9b8141b
      size: 111560
    - path: results/unconditional_coupling_flow_moons/train.log
      hash: md5
      md5: 5fd12f7090d6914d393ad12d9aec5551
      size: 2200
  unconditional@coupling_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@coupling_flow-circles coupling_flow circles
      results/unconditional_coupling_flow_circles --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.coupling_flow.circles*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            num_layers: 1
            order: 50
          parameter_kwargs:
            hidden_units:
            - 16
            - 16
            activation: relu
            batch_norm: false
            dropout: 0
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_coupling_flow_circles/dataset.pdf
      hash: md5
      md5: c3516f8fb8f2bee7f287ca38db3cfa4b
      size: 25008
    - path: results/unconditional_coupling_flow_circles/mcp
      hash: md5
      md5: a21a961a8c3f5c7d8c2825b5f3315e9f.dir
      size: 703
      nfiles: 3
    - path: results/unconditional_coupling_flow_circles/metrics.yaml
      hash: md5
      md5: 1a87ff8ebcc0e7af0d31509ddaeb4819
      size: 54
    - path: results/unconditional_coupling_flow_circles/samples.pdf
      hash: md5
      md5: 890923dff7d51a7b3f5de623753ddde9
      size: 106797
    - path: results/unconditional_coupling_flow_circles/train.log
      hash: md5
      md5: 14d00c3601f8c4d7bd8ba34342e6deec
      size: 1942
  unconditional@masked_autoregressive_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@masked_autoregressive_flow-moons masked_autoregressive_flow
      moons results/unconditional_masked_autoregressive_flow_moons --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.masked_autoregressive_flow.moons*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 10
            num_layers: 4
          parameter_kwargs:
            hidden_units:
            - 16
            - 16
            - 16
            activation: relu
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_masked_autoregressive_flow_moons/dataset.pdf
      hash: md5
      md5: 812ec1da32247a24277e418ac997602b
      size: 24850
    - path: results/unconditional_masked_autoregressive_flow_moons/mcp
      hash: md5
      md5: a21a961a8c3f5c7d8c2825b5f3315e9f.dir
      size: 703
      nfiles: 3
    - path: results/unconditional_masked_autoregressive_flow_moons/metrics.yaml
      hash: md5
      md5: c52de21d7eb5ab7e887e225af1e54f08
      size: 53
    - path: results/unconditional_masked_autoregressive_flow_moons/samples.pdf
      hash: md5
      md5: 1c24bf4f5e8d1ec5108e4ce9f77f9929
      size: 73862
    - path: results/unconditional_masked_autoregressive_flow_moons/train.log
      hash: md5
      md5: 77becfe5fb278a0c95bf48a2ae9e5f9e
      size: 1932
  unconditional@masked_autoregressive_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@masked_autoregressive_flow-circles masked_autoregressive_flow
      circles results/unconditional_masked_autoregressive_flow_circles --test-mode=true
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.masked_autoregressive_flow.circles*:
          distribution_kwargs:
            bijector_name: bernstein_poly
            low: -3
            high: 3
            bounds: smooth
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 50
          parameter_kwargs:
            hidden_units:
            - 16
            - 16
            activation: relu
          fit_kwargs:
            epochs: 10000
            batch_size: 256
            early_stopping: 4
            learning_rate: 0.01
            lr_patience: 25
            lr_reduction_factor: 0.5
            monitor: val_loss
            reduce_lr_on_plateau: true
            verbose: true
            validation_split: 0.1
    outs:
    - path: results/unconditional_masked_autoregressive_flow_circles/dataset.pdf
      hash: md5
      md5: 98d57b1d96cd9fdc0ff500594ee209a7
      size: 25008
    - path: results/unconditional_masked_autoregressive_flow_circles/mcp
      hash: md5
      md5: a21a961a8c3f5c7d8c2825b5f3315e9f.dir
      size: 703
      nfiles: 3
    - path: results/unconditional_masked_autoregressive_flow_circles/metrics.yaml
      hash: md5
      md5: 5d97d6309f278f94bbbb169904a2ac29
      size: 53
    - path: results/unconditional_masked_autoregressive_flow_circles/samples.pdf
      hash: md5
      md5: 2333e396a52a3c4e93ec1c9449351c80
      size: 102987
    - path: results/unconditional_masked_autoregressive_flow_circles/train.log
      hash: md5
      md5: 5d53f12248e474f863598389cb59ea8e
      size: 1941
  unconditional_benchmark@elementwise_flow-bsds300:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-benchmark-bsds300 unconditional_benchmark@elementwise_flow-bsds300
      elementwise_flow bsds300 results/unconditional_benchmark_elementwise_flow_bsds300
      --test-mode=false
    deps:
    - path: datasets/bsds300_train.npy
      hash: md5
      md5: 10d58c2a7b77aafde3461874f48c1f1d
      size: 252000128
    - path: datasets/bsds300_validate.npy
      hash: md5
      md5: e9fcc5f84740aa2ee46be1e58fe07962
      size: 12600128
    - path: pyproject.toml
      hash: md5
      md5: c4eb8784437477c5a61c5ead52221ca2
      size: 1972
    - path: scripts/train.py
      hash: md5
      md5: 98de012db80197d909e412e2fa8c189a
      size: 7552
    - path: src/mctm
      hash: md5
      md5: 1cdfc75a030f96e9fc75d4e586f0fe67.dir
      size: 73426
      nfiles: 15
    params:
      params.yaml:
        benchmark_datasets.bsds300*:
          scale: 0.537
          shift: 0.914
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.elementwise_flow.bsds300*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -2
            high: 2
            smooth_bounds: true
            allow_flexible_bounds: true
            shift: false
            scale: false
            order: 100
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 1000
            batch_size: 256
            learning_rate: polynomial_decay
            polynomial_decay_kwds:
              initial_learning_rate: 0.01
              end_learning_rate: 1e-05
              power: 1
              decay_steps: 1000
            lr_patience:
            reduce_lr_on_plateau: false
            early_stopping: 100
            monitor: val_loss
            verbose: true
    outs:
    - path: results/unconditional_benchmark_elementwise_flow_bsds300/mcp
      hash: md5
      md5: dc452b6c9427b893174c4932fd5c7b17.dir
      size: 76923
      nfiles: 3
    - path: results/unconditional_benchmark_elementwise_flow_bsds300/metrics.yaml
      hash: md5
      md5: 46060fcd14cf21979207cd1689348648
      size: 56
    - path: results/unconditional_benchmark_elementwise_flow_bsds300/train.log
      hash: md5
      md5: ad2f1e01e415dcb0683aa6108e0d4230
      size: 2078
  unconditional_benchmark@masked_autoregressive_flow-power:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-benchmark-power unconditional_benchmark@masked_autoregressive_flow-power
      masked_autoregressive_flow power results/unconditional_benchmark_masked_autoregressive_flow_power
      --test-mode=true
    deps:
    - path: datasets/power_train.npy
      hash: md5
      md5: b4e926bbb226067d4f02b51fa2849ca2
      size: 39838136
    - path: datasets/power_validate.npy
      hash: md5
      md5: a39220ef08007fba1768aef08f9c91cf
      size: 4426568
    - path: pyproject.toml
      hash: md5
      md5: 2a54ba60e8ef29904fb8d0cef7f12cae
      size: 1977
    - path: scripts/train.py
      hash: md5
      md5: b8abe5a0490f79c11c5ac593ef939e98
      size: 7938
    - path: src/mctm
      hash: md5
      md5: 93c9a244f1df71804f2202b31be4c442.dir
      size: 84575
      nfiles: 16
    params:
      params.yaml:
        benchmark_datasets.power*:
          scale: 0.05
          shift: 5.456
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.masked_autoregressive_flow.power*:
          distribution_kwargs:
            allow_flexible_bounds: true
            bijector_name: bernstein_poly
  train-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 512
            - 32
            - 512
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 60ad4f3c77637e5c5e5b008fdbe74684
      size: 319803
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: d5e418513bd7f0ab54ccba64ddaa1459
      size: 54
    - path:
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: aca60eaccf9b3d69f53bd5ebe8e48f82
      size: 9078456
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: b581941e9031ab8bce8bd75715991180
      size: 304293
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 0327da80b6cfbe93e2c9e8846b3081c3
      size: 5891
  eval-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: aca60eaccf9b3d69f53bd5ebe8e48f82
      size: 9078456
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 512
            - 32
            - 512
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: b24818055b3d2a1a405d885d75d45aac.dir
      size: 827822
      nfiles: 2
  train-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: bae9db5d107584ca175d76c583a57aed
      size: 319803
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 4291aba36e5a1c6ed6280b38c78516c0
      size: 55
    - path:
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 94f80acc291bad6acdd1cc4bdcb35529
      size: 1752808
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: f953b5751b4b0d370e111a278e37187e
      size: 303914
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 797a57a11cd1aac16d2f5109811212da
      size: 5348
  eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 94f80acc291bad6acdd1cc4bdcb35529
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: efe8d310e0fbafe2716d272ff4a43f1e.dir
      size: 828538
      nfiles: 2
  train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 3bd5f33a3529c794175b6bd81fcb38d7
      size: 319803
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 0e28cb8ae63c83af90574412f192e0e2
      size: 55
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 375f65994d377337bdb13acd9c49009f
      size: 1622704
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 3b950a38d1e8db017ea6b708ef6b8fce
      size: 271025
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: c19cd7056cdd391f98c046cf6d83a31d
      size: 5432
  train-sim@dataset0-conditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_normal --stage-name train-sim@dataset0-conditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 07493b697e60525d740d920d3d30fd92
      size: 319803
    - path: results/sim/moons/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: fa983cbc05f9f2801ad7b856c98a4b2e
      size: 56
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: fa0a26ba687be55cd87b25030dd2d7b0
      size: 55560
    - path: results/sim/moons/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 02aeba174541854b5b20275c1e10f8ba
      size: 278484
    - path: results/sim/moons/conditional_multivariate_normal/train.log
      hash: md5
      md5: a7bc65220c4dab672ef27b49adcfdadb
      size: 2247
  eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 375f65994d377337bdb13acd9c49009f
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 8318ad2d514c60b29aed7c3057226f5e.dir
      size: 816908
      nfiles: 2
  train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: faf442ebb688d0c4752b76ce89c736e6
      size: 319803
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 099a5fcdda5f4a68e1b5df4e9cb33959
      size: 56
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: f88f26da0adcf8665021bbd1bbbe5fa2
      size: 1418896
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: af7c0d4339ca539f68e3af3ab863b615
      size: 300964
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 4e7da8395205e6712c2d478986b76ec4
      size: 4990
  eval-sim@dataset0-conditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset0-conditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: fa0a26ba687be55cd87b25030dd2d7b0
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: d566f12d24ccdf00ca93e780311c0a1e.dir
      size: 804933
      nfiles: 2
  train-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 65830b4022f91cbd951118faf48c3921
      size: 319803
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: ef4cf2573865ec79939cef7eda679678
      size: 55
    - path:
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 9110bb0d5ad8f8b435d9e30820a110ad
      size: 2228400
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 47f8b7fb9112f405200ae3f6a315042a
      size: 293485
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: d003acb1381a5606ece499431b2b8f33
      size: 5085
  eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: f88f26da0adcf8665021bbd1bbbe5fa2
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 989fe343dba431d55f6023809d9220a2.dir
      size: 846916
      nfiles: 2
  eval-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 9110bb0d5ad8f8b435d9e30820a110ad
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 7e8f7672e0922535fc977d0aa441c6af.dir
      size: 831518
      nfiles: 2
  train-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_transformation_model --stage-name train-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 07ef2e9040a21a58cea8bfecc096fc19
      size: 319803
    - path: results/sim/moons/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 61cb9e98fd9e7306839ba76c73eaf149
      size: 56
    - path:
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 7390df5c0976d7115189acf1ce459704
      size: 11544
    - path: results/sim/moons/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: db30107eb97f6e5bb380a7427522a996
      size: 264427
    - path: results/sim/moons/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: f08d372a4d985297462d13dc9018bace
      size: 5207
  eval-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 7390df5c0976d7115189acf1ce459704
      size: 11544
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 39f6a5aec5bd5fc708dd9db1138f69fd.dir
      size: 4271937
      nfiles: 8
  train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 5e9b426c39b9611c9977c974a2027fd7
      size: 319803
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 04152cf0a742c7c65fa5bafb380f3826
      size: 56
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 390f28992f86fe994b9fb8993f796a5c
      size: 1622704
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: f81f0e89246e392e90e3eec4ccdf2272
      size: 302629
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 05eacc3923bf80407f4761e5cf6bd4e9
      size: 5086
  train-sim@dataset0-unconditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_normal --stage-name train-sim@dataset0-unconditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: f41c8529289cc3630043d10d1ecde211
      size: 319803
    - path: results/sim/moons/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 2463a453e603e0dbf0b5770901027fb1
      size: 58
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 5911639453fbe373a0dccf83a7e9564c
      size: 11000
    - path: results/sim/moons/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: dfdbe9b42909447d080686c0263723a3
      size: 303572
    - path: results/sim/moons/unconditional_multivariate_normal/train.log
      hash: md5
      md5: 31b65f8616e8122a0d4a8415810262d3
      size: 1986
  train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 4d4dcee8d537670b1a89f507cdfdda6d
      size: 319803
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 3d26ec8d77dcbf4e2883b9397fa7fe16
      size: 54
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 6d1aad486e6c207a2e8c5d78ba7cdd2b
      size: 4547696
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 117c2813651222c14d1413a62fbfde43
      size: 307388
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 255fbede8986ff4b392818456ee9025c
      size: 6445
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 390f28992f86fe994b9fb8993f796a5c
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: f031ffb56c1facd27a8d96285d0b0347.dir
      size: 809027
      nfiles: 2
  eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 6d1aad486e6c207a2e8c5d78ba7cdd2b
      size: 4547696
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 1e1b0d4150a901f999d44e68b8e30cf3.dir
      size: 4440150
      nfiles: 8
  train-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 4009ab15abdb9be2dc758cc32dca62a2
      size: 319803
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: a30deee4f9d4df9ca837524f950374aa
      size: 56
    - path:
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 2be8f626f67c8682bffc0d9fb6357246
      size: 1119168
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 7e9d4656118eaa331259a469fb8b7af4
      size: 279267
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: b6a1f128f541b768d0321660abfaf689
      size: 4739
  eval-sim@dataset0-unconditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset0-unconditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 5911639453fbe373a0dccf83a7e9564c
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 0aa71d11f04bcbcf686d4aca007e43ca.dir
      size: 796161
      nfiles: 2
  train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 34ca99a889c76d138c0cf18190e3c390
      size: 319803
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 93fe6bcbe0d0193e89cacfbe0b7db5bb
      size: 55
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: c848acbbea995b20a8deb763dbfdbf81
      size: 1418896
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 2b44866fa6cb11d0afc983a730a51678
      size: 303132
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: eecfea98fc1a61ed2c21238c0df4a831
      size: 4642
  train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 54312da1800eedec0e90756f2628e871
      size: 319803
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 348123d7203b6c41f99c5aad44486616
      size: 55
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: efb5c90da3f0358a1de395a45b380f6d
      size: 1124088
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: e4bd0d12df8ee6e5496c078c3b049f74
      size: 306949
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 7fce423e9562a1ba3c79ea7efd9810e3
      size: 5857
  eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 2be8f626f67c8682bffc0d9fb6357246
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: df14012f3c170b5d29879a1e18d453b1.dir
      size: 819411
      nfiles: 2
  eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: efb5c90da3f0358a1de395a45b380f6d
      size: 1124088
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 200
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 3c947b86a160b5184eb1e7eddf62769d.dir
      size: 4424057
      nfiles: 8
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: c848acbbea995b20a8deb763dbfdbf81
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: f9219d36a4d552023fd94b52297cb5cc.dir
      size: 842759
      nfiles: 2
  train-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_transformation_model --stage-name train-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 2e1b1b315351f9c06d4ef1d148be33f3
      size: 319803
    - path: results/sim/moons/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 2d541c539bf4489e267ef19c55d437cd
      size: 56
    - path:
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 2b5a415db763c325e3231c657422fd33
      size: 11272
    - path: results/sim/moons/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 799da0f24c9cf3fec280f20943192e9e
      size: 295325
    - path: results/sim/moons/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: c1baa7168263f50d97617f18299f0d74
      size: 4006
  train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 512
          learning_rate: 0.08
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: cb51c766aa01bb52366ec65bd1e527c9
      size: 319803
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 3be42881526385319284adc81180be91
      size: 56
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 67827d0f2de2a111acc46dfc2ce05fe8
      size: 565208
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 2cc1c5f680d5db5f8434a44b00a47e58
      size: 307658
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 350a6d4788a39d46ca2ecc1b3a0070b8
      size: 5398
  eval-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 2b5a415db763c325e3231c657422fd33
      size: 11272
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: c01b2ebe02dff77fb132af27b84ed322.dir
      size: 4363056
      nfiles: 8
  train-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 128
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: cf96a7152e584fa54d8ba8864cbac792
      size: 320937
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: d8b435fc6767b685164733e57971b320
      size: 56
    - path:
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: f822a7f0c934b55da663c9bb49ad82ff
      size: 2432984
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 9e545be764903112980cb7525e7f2e8e
      size: 297604
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 2317e11a8187c5adb2dbfa354e109cdd
      size: 5751
  train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: dc3e0fdcad6b34b6b2be475a6df463a1
      size: 320937
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: fa6b9cc203c7302cdafe3f6e1ae5db13
      size: 55
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 70c832cf3790d87f2d801e416842f8e8
      size: 1622704
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: f0099d328cd9d237bd81baaf3250daf6
      size: 282005
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 7b7bc8b7bc31a05e6003cd177a758c14
      size: 5486
  eval-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: f822a7f0c934b55da663c9bb49ad82ff
      size: 2432984
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 128
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: e9188d4194c7afcc05aa283802fcfb4d.dir
      size: 879298
      nfiles: 2
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 67827d0f2de2a111acc46dfc2ce05fe8
      size: 565208
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 512
          learning_rate: 0.08
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.002
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 35e505ffe10a49bfa20d9eee4774c90c.dir
      size: 4429290
      nfiles: 8
  eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 70c832cf3790d87f2d801e416842f8e8
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: e92b6aae876e984ff2aa7f35ef8fb430.dir
      size: 834894
      nfiles: 2
  train-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: dd3b82c629c8c2cd3698de5cf3df3f5b
      size: 320937
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 422e5bd66c437b6072ecdcdaef3e6362
      size: 56
    - path:
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 866b4cbdb60b9698d8c24c84d010b1d3
      size: 2228400
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 78e50399c8f986530614903d7dbbc48c
      size: 279372
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 4c642dad4048493d0a112c512d18981b
      size: 5139
  train-sim@dataset1-conditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_normal --stage-name train-sim@dataset1-conditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 7b8a563259aa915668dfb2ac977e8714
      size: 320937
    - path: results/sim/circles/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: d7a049ed023ee2675a46f5f206aa3028
      size: 57
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 9a9c4a8ff2493883892b1ac7205e626e
      size: 55560
    - path: results/sim/circles/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: c3e365facafa1f022e918203952642ad
      size: 300793
    - path: results/sim/circles/conditional_multivariate_normal/train.log
      hash: md5
      md5: a0dbd67f6ae0c4e596d38c5f7b72973f
      size: 2303
  train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 91185909738aecfe631142a9b4588294
      size: 320937
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: b6e006fda2ee568b7a0b87a17b37e9d8
      size: 56
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 9cf10238229675184d6d1e476753d2fc
      size: 1418896
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: dda893b7ab18c9831cb532a0e1e52e57
      size: 293017
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 908bde5b1008067b1f04c3b15395cc65
      size: 4845
  eval-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 866b4cbdb60b9698d8c24c84d010b1d3
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: d6245f883517a9c3650a57cc533565b6.dir
      size: 848362
      nfiles: 2
  eval-sim@dataset1-conditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset1-conditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 9a9c4a8ff2493883892b1ac7205e626e
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 6a3555c7611ccfe44969f15667eb82cc.dir
      size: 794206
      nfiles: 2
  train-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_transformation_model --stage-name train-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: b6383b24928cdfe992cc0d867bf1a0df
      size: 320937
    - path: results/sim/circles/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 12de4ea687ec5a9a4efbc6d78de60dd0
      size: 57
    - path:
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 98a03e3cf6a38ec7d255f481a828d4cf
      size: 11544
    - path: results/sim/circles/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: ccd112278f3ac43770f12228e4335a19
      size: 286372
    - path: results/sim/circles/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 41fe36c5ef1603b78baf894c958efe57
      size: 5260
  eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 9cf10238229675184d6d1e476753d2fc
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: d1885fbfaef93d82f741424c7e6c5b3c.dir
      size: 874544
      nfiles: 2
  eval-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 98a03e3cf6a38ec7d255f481a828d4cf
      size: 11544
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: dcc22d98e4b4a82e4d6d0d8cccaf08ae.dir
      size: 4442313
      nfiles: 8
  train-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 5eeee4c7a0b99fe2b7de5f64ebecd40c
      size: 320937
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 25aa9c547d7fcd1d6bd4e9508185b166
      size: 55
    - path:
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8134bc66c43bc577062dc561a193b2ed
      size: 1752808
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 3329d477673e6cdefdbd3315f8ecc3d5
      size: 288645
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 5ec63ebd3dfa54973137b23ca357229d
      size: 5403
  train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: b8dd20c3c1ca84e4a61ae303b076915c
      size: 320937
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: c7729e0893ab2e0a68753bc1931531a7
      size: 56
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c7df848fb599d9a9ef1c684e800a8393
      size: 7941280
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: e1c1c7a43e4c146856a13b8d7b538069
      size: 306823
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 8779dcdf5bf1d3deafa722420a232e28
      size: 6501
  eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c7df848fb599d9a9ef1c684e800a8393
      size: 7941280
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 2e34f227eb95bf0f86c4a1b52f1c6979.dir
      size: 4457545
      nfiles: 8
  train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 46dfc8b18850d410e01be0d194134f69
      size: 320937
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 57d317ab5f0ecb8bae3c683c36bd7e4e
      size: 56
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36121a6c079bde59d7e292ab0faba746
      size: 1622704
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 722722eab9c7c1aa9ea78f72b0ed54c5
      size: 272153
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 17260a83c704bfb9e86afb82972467d0
      size: 5140
  eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8134bc66c43bc577062dc561a193b2ed
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 200
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 19cb3e171974992cfba7286c11354105.dir
      size: 853004
      nfiles: 2
  train-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 88bbafb32bb9e18008ae04c3b17f85f5
      size: 320937
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 6965a3e90b875373d223ab3e36368371
      size: 55
    - path:
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: a6c7a7908300d43f551afe7ed62d6b36
      size: 1119168
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 54226b230072b482ff766554eca32cf3
      size: 278670
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: f07c1f9df16825c6b1cc38b0300a7032
      size: 4792
  train-sim@dataset1-unconditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_normal --stage-name train-sim@dataset1-unconditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: d34bdc494004ac68923b0856caf923c7
      size: 320937
    - path: results/sim/circles/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 8cc350439752688b2a4dfe4b3a32b27f
      size: 58
    - path:
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: e11f5beb4f4a9b72392640ec43218c4b
      size: 11000
    - path: results/sim/circles/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 2fc28a1054ddbb964f405fc577d15204
      size: 274064
    - path: results/sim/circles/unconditional_multivariate_normal/train.log
      hash: md5
      md5: 8f64255bd82fd80b854b756d473277df
      size: 2041
  eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: a6c7a7908300d43f551afe7ed62d6b36
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 2f880ab8af0c68844978566617bc66cb.dir
      size: 830980
      nfiles: 2
  train-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_transformation_model --stage-name train-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: eefb46280d92acaaf321210e054320f8
      size: 320937
    - path: results/sim/circles/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 16db146e454744da661b5994981b76f8
      size: 56
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: b63b28fae2925bba5138f5a8c304e396
      size: 11272
    - path: results/sim/circles/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 427b2ec2083f73015853ca6bad0cf7ed
      size: 289960
    - path: results/sim/circles/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 84793e4975ac2581fbbbd8044962898a
      size: 4061
  eval-sim@dataset1-unconditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset1-unconditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: e11f5beb4f4a9b72392640ec43218c4b
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 65ce732e688ece6d680081ef69799a91.dir
      size: 807424
      nfiles: 2
  train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 64
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 191
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 5628a4c1bcf9f41a215544d47bac32c5
      size: 320937
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 4c846410e86b4df20c333baa61534377
      size: 56
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: fd3cb957b976f83cf837036a85098273
      size: 6904564
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: a55e12306ef329f0d9c3d952e6a8bd1f
      size: 311995
    - path: results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: e56f8c78fd59fa0c5f7b9753a10ae4f8
      size: 5909
  eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: fd3cb957b976f83cf837036a85098273
      size: 6904564
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.003
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 64
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 191
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: f90137af4ee0b71470a60b3f2cf30f72.dir
      size: 4464819
      nfiles: 8
  train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 68207400109b4e752c196290c4402b1f
      size: 320937
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: c2406df2a12d0de3dd7126583d0ea8ab
      size: 56
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 1ced6417a6166151b0f47e2bc3bae91e
      size: 1418896
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 96a4feabf6f2ff3befedce64c1ea4ea9
      size: 296349
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 82c5bd23c7a76fbeace026d8acf17a50
      size: 4697
  eval-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: b63b28fae2925bba5138f5a8c304e396
      size: 11272
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 100
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: mctm.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 2d67789b2071521c4b5d870ddd2ab061.dir
      size: 4464002
      nfiles: 8
  train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 100
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 65aaaf7787abf9f5957bde6b6b37386c
      size: 320937
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: f46b0745b9ff83aa9dfaed4d24de1fd9
      size: 56
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 722cddbcb7cabd0ecc87f2f0ba092e1f
      size: 1016192
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: c02ca620bb0155f60ee7640ebb33d664
      size: 313362
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 40fc30f4e7a170c9f92085f82072d12d
      size: 5451
  train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 100
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: bf725c7e79f319fb002a80ebc54e9426
      size: 320937
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 2ea3667cc5b8886a52be863c7a00084d
      size: 56
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 5408a8b0049d991cc0e7367fb31c723d
      size: 19085448
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: ea7e5cee6465ac2902d51b30c8af6595
      size: 301132
    - path: results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 2f868d157b01c1fce588f94739af3ddb
      size: 5844
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 722cddbcb7cabd0ecc87f2f0ba092e1f
      size: 1016192
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 100
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b1dbfde53f215f12c8587cc99472251d.dir
      size: 4525511
      nfiles: 8
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 5408a8b0049d991cc0e7367fb31c723d
      size: 19085448
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 100
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 327470b9d545f8065a93025aa7336c72.dir
      size: 4503985
      nfiles: 8
  train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 512
          learning_rate: 0.08
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: b04f974c2ef717b5231ca56c6fb9ac39
      size: 319803
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 99bb4a4d6d00833cb9d1c41d70836968
      size: 56
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: b0876d4333e7838e13e5c77dd45c5610
      size: 27005304
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 397192f538b0a4a5ad05b07bc8f2b52a
      size: 308149
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 874bcd0a684599427788fd27efd4f2f0
      size: 5992
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: b0876d4333e7838e13e5c77dd45c5610
      size: 27005304
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 512
          learning_rate: 0.08
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 1024
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: mctm.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: e760062d734c97b8f1f91a86e95976cc.dir
      size: 4428625
      nfiles: 8
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36121a6c079bde59d7e292ab0faba746
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: d8410220632315268a61f7f1720e338d.dir
      size: 860610
      nfiles: 2
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: ddb8eac9b1f83a79ec53edea8eff510a
      size: 2153
    - path: ../src/mctm/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/mctm/activations.py
      hash: md5
      md5: fbcc1a7e509e4df7654ccd420ee95cca
      size: 6973
    - path: ../src/mctm/data/__init__.py
      hash: md5
      md5: 4a66435a5d3d88b2a2cb930f9dd75384
      size: 3776
    - path: ../src/mctm/data/sklearn_datasets.py
      hash: md5
      md5: 29e0ff47d6231053f17b8cb92a424084
      size: 1192
    - path: ../src/mctm/distributions.py
      hash: md5
      md5: 545ee87e6f74417d916cdac14f8208ae
      size: 48296
    - path: ../src/mctm/models.py
      hash: md5
      md5: 90f4b787d72c793e88c9be15b809c16b
      size: 14802
    - path: ../src/mctm/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/mctm/parameters.py
      hash: md5
      md5: 19c65d534f5c392d511700cd8e1bd646
      size: 14411
    - path: ../src/mctm/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/mctm/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/mctm/utils/__init__.py
      hash: md5
      md5: a1933c0f39ff956afb3724558bb46e58
      size: 5773
    - path: ../src/mctm/utils/decorators.py
      hash: md5
      md5: 8f38fef6acf3e8cf79ef3b52290d32d0
      size: 3799
    - path: ../src/mctm/utils/mlflow.py
      hash: md5
      md5: eded3b88cd993d91b643e7cd771dca7e
      size: 3108
    - path: ../src/mctm/utils/pipeline.py
      hash: md5
      md5: f12bf6f4e3d68f227ec0da7955c7ea42
      size: 11830
    - path: ../src/mctm/utils/tensorflow.py
      hash: md5
      md5: b02c6edc4bb42e28c719c386ed979016
      size: 6388
    - path: ../src/mctm/utils/visualisation.py
      hash: md5
      md5: 34c10cbb936bb72d54906737ce50e5f3
      size: 17301
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 1ced6417a6166151b0f47e2bc3bae91e
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 9d886e881ff928829a5a1d95330fb800
      size: 13574
    - path: scripts/train.py
      hash: md5
      md5: f1fb8fddb9af2c5e47c7c22f4c055eea
      size: 10129
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.005
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 78a2d6cde490307194b3ed56b0885890.dir
      size: 841503
      nfiles: 2
