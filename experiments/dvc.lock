schema: '2.0'
stages:
  train-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset0-conditional_coupling_flow_bernstein_poly --dataset-type
      sim --dataset-name moons --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 7ecd6f6ba1b97b5f3ee769fc5de737ce
      size: 72412
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 5fdf394be1171490af3231db028ebea6
      size: 54
    - path: 
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c20671ea8d37a0c24c038541d5b21e62
      size: 3498008
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: cfe558cd0a4c76e751c1a0f8714ac7ad
      size: 133291
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: a45eaa1cfd5e594b61c81a7dcdd6f9ea
      size: 5943
  train-sim@dataset0-unconditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_multivariate_normal
      --stage-name train-sim@dataset0-unconditional_multivariate_normal --dataset-type
      sim --dataset-name moons --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: ad819949b2b28db7d10554ab507da126
      size: 72412
    - path: results/sim/moons/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 83a658f6185d1f2476711dc22afb4e1a
      size: 53
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 650a45520e6bb4b049ffc30bb4afd958
      size: 11000
    - path: results/sim/moons/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 50e910cc978130450509038e2dd88b8d
      size: 133393
    - path: results/sim/moons/unconditional_multivariate_normal/train.log
      hash: md5
      md5: c9226e9a1755da6511e006094b02abfc
      size: 2005
  train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_masked_autoregressive_flow_bernstein_poly
      --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a97ce04470da4849666761c482185cfd
      size: 72755
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 01e7ba1545aa9afc4e653afdd0c34701
      size: 53
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32f65d06ff0a45f7e6d63f96a4051404
      size: 1622704
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 5c17de06140cf2eb51b845042e63afba
      size: 134194
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 5f8c655fb47100825025919538b33177
      size: 5185
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32f65d06ff0a45f7e6d63f96a4051404
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 4b284828fe8379f27ac7ddc07d313914.dir
      size: 618961
      nfiles: 2
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: b9d0137816ae1dd110712994cac2b6bb
      size: 30
  train-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset0-conditional_coupling_flow_quadratic_spline --dataset-type
      sim --dataset-name moons --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 7ecd6f6ba1b97b5f3ee769fc5de737ce
      size: 72412
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 0ec16efa61d7406ca0957a316a8b625a
      size: 54
    - path: 
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 763244e8c82aa2d05b30b9c72cb6d550
      size: 2228400
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: a9cfec71689dedca79f54268e62c02f6
      size: 130111
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: e6f333d308e3b6cbb67fa1777bbe54ec
      size: 5131
  train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_masked_autoregressive_flow_bernstein_poly
      --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 7ecd6f6ba1b97b5f3ee769fc5de737ce
      size: 72412
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 3756e1a86ab24778393a28e4ff32b12f
      size: 53
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 1f8d182d1f934519d95c19bf5bdb6fbd
      size: 1622704
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 02143719bae503df881f1a03bd77364d
      size: 134125
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: f7d67cd2825e29ea82a8f68a6790417a
      size: 5477
  train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_masked_autoregressive_flow_quadratic_spline
      --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: aa779682ff6f13cfc0c7308f0e93fa4e
      size: 72412
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 07a511e6d7de6353df0b1b1613c7fa8f
      size: 52
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7e0daffcacaa3744bfe55f85c970bd26
      size: 1418896
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: d12e66843afacdf3e3d223762f188a93
      size: 130052
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 44394f85ad50116e906a43df9e19d44e
      size: 5033
  train-sim@dataset0-conditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_multivariate_normal
      --stage-name train-sim@dataset0-conditional_multivariate_normal --dataset-type
      sim --dataset-name moons --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 1abb4a74ba9a782fb7c37b6fce8b05eb
      size: 72412
    - path: results/sim/moons/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: bbcd5ed41ab24c6eefc1ee05f6682b24
      size: 54
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: df91f319469a53c3739793fc7b51a6c9
      size: 55560
    - path: results/sim/moons/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 2b68902e2e9197c041661ab301c85d51
      size: 129689
    - path: results/sim/moons/conditional_multivariate_normal/train.log
      hash: md5
      md5: 6dfdbdfcd87629b0d68c696e6dba8fa1
      size: 2269
  train-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_multivariate_transformation_model
      --stage-name train-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 48598643fc293b120ec85b97e8c3aa03
      size: 72412
    - path: results/sim/moons/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 3824b13f05d5fa6a1b659299375d0510
      size: 54
    - path: 
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 9d20cbc285e9730ca580f8f9ee9c86be
      size: 13944
    - path: results/sim/moons/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 8dd852984ec06a76aaddd5349eba92b1
      size: 143885
    - path: results/sim/moons/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 87e517d83e51a821379091d7bba8958e
      size: 5276
  train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_hybrid_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: ad819949b2b28db7d10554ab507da126
      size: 72412
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 6487c2e62ae7388ed8b1a3550c3cb59f
      size: 54
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 751d439fb4cc605f62efd40cf192d623
      size: 4547696
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: fd451f41b73cf1ec27e854ea6ab6c7d9
      size: 149125
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: d48895b041e418b8844322c9e3e6897f
      size: 6315
  train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_hybrid_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 905cf3e275d338545234f8e0262eb4b1
      size: 72412
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: decd5e7bf7a17ab91b016681967faba3
      size: 54
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 83360aac50bd20d363aa95f83e938891
      size: 1124088
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: b35aee43fae20e6d7ae8ad67bdcd749b
      size: 150103
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 4f0dff06f2a7879ead74bc1c53a80623
      size: 5716
  train-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset0-unconditional_coupling_flow_bernstein_poly --dataset-type
      sim --dataset-name moons --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 2139fc3702f141a44c3ce71db5394611
      size: 72412
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: c9be59e8b20f1a8f48d339cf788998a6
      size: 54
    - path: 
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 6c2171e0abf7aee4ef7912af739c446e
      size: 1752808
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: a5307f324e1e3497082c525a92cdd0ee
      size: 132059
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 67a6472d4c51e0db2afbda00bea834e3
      size: 5596
  train-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: ad819949b2b28db7d10554ab507da126
      size: 72412
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 0685e6f888128680b60218fe1a72a543
      size: 53
    - path: 
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 209da26cdfdd33d2e8136c5bc5c9783a
      size: 1119168
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 0b70b3e1d21a4c0a231a734300559022
      size: 129406
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 1536cd01aca5dbb6902bda97784c62d4
      size: 4783
  train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_masked_autoregressive_flow_bernstein_poly
      --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 905cf3e275d338545234f8e0262eb4b1
      size: 72412
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 3756e1a86ab24778393a28e4ff32b12f
      size: 53
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 1f8d182d1f934519d95c19bf5bdb6fbd
      size: 1622704
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: b504cd056c4ef794d580940a5a655cdd
      size: 134125
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: f577bd9e6e97debe049b6857e2d790ad
      size: 5130
  train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_masked_autoregressive_flow_quadratic_spline
      --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 9be18188d63c52d476e2f2ba805315a2
      size: 72412
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 07a511e6d7de6353df0b1b1613c7fa8f
      size: 52
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7e0daffcacaa3744bfe55f85c970bd26
      size: 1418896
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 55f3e46f039b1b2e4b93e4e8018dfb88
      size: 130052
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: df6e4cc1258b913e555a7ae3b3cc75c7
      size: 4686
  train-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_multivariate_transformation_model
      --stage-name train-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 301354557e8743ff220b0fb524d7dbee
      size: 72412
    - path: results/sim/moons/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 1c12e75d20bd1ab3a3f1722eb3ef316c
      size: 54
    - path: 
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: c6a68e1e420ef38df494927933b000b1
      size: 13672
    - path: results/sim/moons/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: c717b7b752b96ffb6815c90dd468c94b
      size: 139707
    - path: results/sim/moons/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: be07f038a68ee5d42f5cbb1a25f23b41
      size: 4071
  train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_hybrid_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: fd149055bc8ebdf8214a73876acdb025
      size: 72412
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 060908b30519beed63c640c7e60c8621
      size: 54
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: d43978145ec3900d3ed87af9f2cfc28f
      size: 27005304
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 2d0ebd42ba6e4e3b7fb96e547ea7528e
      size: 140775
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 89b5e861b9602c59ea2c266211a35edc
      size: 5660
  train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_hybrid_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 905cf3e275d338545234f8e0262eb4b1
      size: 72412
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 6edabb488f6c6b2d0148857ece2cd5d0
      size: 53
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: e0a831371e4207ea55799dba61089943
      size: 565208
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 2ebc5d8cdeb652f3c6d38e65227f863c
      size: 140100
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: d320f6623d2fffd80ea370745b1bd251
      size: 5455
  train-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset1-conditional_coupling_flow_bernstein_poly --dataset-type
      sim --dataset-name circles --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 70bce2fa13f388a331d25ccd8c3845a3
      size: 54
    - path: 
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 4ea924d7b24ad54e82e26ecdf88c676e
      size: 3498008
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 39d15c5d052844bbbc0eb3d89c4208e2
      size: 133446
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: cbdb763939f108e099ac70ce5a75b608
      size: 5998
  train-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset1-conditional_coupling_flow_quadratic_spline --dataset-type
      sim --dataset-name circles --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 834e509b5ba5878a0bb4605aea0d0b89
      size: 53
    - path: 
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 152d7c8d3f53c804c0f0a532b972efe0
      size: 2228400
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: cee5aea8b988895dd167c9923ed3d92a
      size: 134241
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: b966c58c014ccd0dcf9ba1c7466362a0
      size: 5185
  train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_masked_autoregressive_flow_bernstein_poly
      --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 13e4758b16cd3d3e03ba9581f4f2948c
      size: 72755
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 01e7ba1545aa9afc4e653afdd0c34701
      size: 53
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32f65d06ff0a45f7e6d63f96a4051404
      size: 1622704
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: f0340cb8a39f65f8e1592b55a6938e32
      size: 134194
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 542a77fa3d64a92eb56fd710f1456f82
      size: 5532
  train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_masked_autoregressive_flow_quadratic_spline
      --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 13e4758b16cd3d3e03ba9581f4f2948c
      size: 72755
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 1a8f2597e3381ad83e5f66b1870fd524
      size: 54
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3d1d0a2a7909df73e2c3e54f45cc2b99
      size: 1418896
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: ad4697c27374dd6d101c094d20b73f04
      size: 134008
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: ffd0d729a2d81b443d8c09466d9cc4b7
      size: 5090
  train-sim@dataset1-conditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_multivariate_normal
      --stage-name train-sim@dataset1-conditional_multivariate_normal --dataset-type
      sim --dataset-name circles --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: results/sim/circles/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: f31423db93375fa98466fa18f1b28b76
      size: 54
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 07fc24f13dcfc2358f5c9cdf24e7d30d
      size: 55560
    - path: results/sim/circles/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 5f993651bbf1845521a8c0e1403f5ee8
      size: 133923
    - path: results/sim/circles/conditional_multivariate_normal/train.log
      hash: md5
      md5: 8d35d672b8091b6d314dd4f2cbe536b2
      size: 2324
  train-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_multivariate_transformation_model
      --stage-name train-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: a97ce04470da4849666761c482185cfd
      size: 72755
    - path: results/sim/circles/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: e4d55923253718f18b8f21dbfd6e7bd4
      size: 54
    - path: 
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 262ed9980b1fcf733c958d11c9456140
      size: 13944
    - path: results/sim/circles/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: c0dfcfb22d69d238cbb8331dc7b5b1d6
      size: 143377
    - path: results/sim/circles/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 306d6b79ae328af12f218003073a0f8e
      size: 5330
  train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_hybrid_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a97ce04470da4849666761c482185cfd
      size: 72755
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: b51c0556e76dd9c6261a3d7cf7d619a4
      size: 54
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8ea68203de5dbca47279cb8783999724
      size: 7941280
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: a1c9fc68c2acc2273abf74c6e31af637
      size: 141024
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 49e748316a13d8a943c92b56c634039b
      size: 6371
  train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name conditional_hybrid_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: b918a6400bc2b9212a80a7344a61b6d2
      size: 53
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: ff90f8f277a5f7a6bae14b8ec80b03dc
      size: 1124088
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: c4300f494e23e3867e57f2ef1ebe7aab
      size: 142380
    - path: results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: ad549f211c467f16265aea3933aabcc7
      size: 5770
  train-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset1-unconditional_coupling_flow_bernstein_poly --dataset-type
      sim --dataset-name circles --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: c2420c2c9d2594976628da1b9e3b88b2
      size: 54
    - path: 
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 400f9878a61628148ba1ce8ae31ee201
      size: 1752808
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 69de696f5f25f91bf600089550f74ff4
      size: 131110
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 494b5eda7040eb4465dbfe03b1f9a119
      size: 5651
  train-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 3a9711f7a5b0a421a5bd3695aa7e6592
      size: 54
    - path: 
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 8356387e72eec8b6a88cc1306367e90d
      size: 1119168
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: be8a303e0db53f0153a6f1f176d0dde7
      size: 133955
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 530049d49bfab394340ebfc915cbbca5
      size: 4839
  train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_masked_autoregressive_flow_quadratic_spline
      --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 1a8f2597e3381ad83e5f66b1870fd524
      size: 54
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3d1d0a2a7909df73e2c3e54f45cc2b99
      size: 1418896
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 2a3888ec0324444ebbcd0dddada08f55
      size: 134008
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: ea879550e455e852ce5a11692707c3ed
      size: 4743
  train-sim@dataset1-unconditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_multivariate_normal
      --stage-name train-sim@dataset1-unconditional_multivariate_normal --dataset-type
      sim --dataset-name circles --results-path results/ --test-mode true --experiment-name
      train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 41fc8c18bff305a3a08a4d3b27254d59
      size: 72755
    - path: results/sim/circles/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 5acea7e77e80ed9e13b9eae4f75cb520
      size: 53
    - path: 
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: ce7379f12ee9558485df2fe7fa0e6875
      size: 11000
    - path: results/sim/circles/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 58a7ca9bcd3dcc730238187f2bd2ac76
      size: 136701
    - path: results/sim/circles/unconditional_multivariate_normal/train.log
      hash: md5
      md5: f7133c7abec20a45285733c29d9cceae
      size: 2060
  train-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_multivariate_transformation_model
      --stage-name train-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: a97ce04470da4849666761c482185cfd
      size: 72755
    - path: results/sim/circles/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 340ce318ac204b4341b177711ce44fe9
      size: 54
    - path: 
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: cd11ba273001417075ae5ecb8a0b8bd7
      size: 13672
    - path: results/sim/circles/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 1713b2468217bfcf94a9b000157ad53e
      size: 140086
    - path: results/sim/circles/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 2f4c9741890508fa5960f7f28809ef5b
      size: 4125
  train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_hybrid_coupling_flow_bernstein_poly
      --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a6d3eea07b82c52ba478247cee855a81
      size: 72755
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 31fa11260f7fe630d8dd3498117ec44d
      size: 54
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 96cd95e3703a941aa9313a9d0d3381c2
      size: 19085448
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 0322f0d40ebb0d30ffbb003000e46411
      size: 141684
    - path: results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: f928baa62d836b1e63144ac22c828b00
      size: 5714
  train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_hybrid_coupling_flow_quadratic_spline
      --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      true --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 01a7967cd6821f294357055c5bcf8339
      size: 72755
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: dc30c4fb524ab7dab5b214468beff9f5
      size: 54
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3e4fb8e8e0d54955dccbd5a73c1ea60d
      size: 565208
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 8c0896842f850f2a37c1368fc49d8c33
      size: 139863
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 7c236e5e47efc9d5e19f026f48a1c5f4
      size: 5511
  eval-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c20671ea8d37a0c24c038541d5b21e62
      size: 3498008
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 21c44207884bfc3623039c3350d6de98.dir
      size: 610036
      nfiles: 2
    - path: 
        results/sim/moons/conditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: df7df16d007f283fcab54fa5f531ec39
      size: 30
  eval-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 763244e8c82aa2d05b30b9c72cb6d550
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: cd1f54742576ec7ceab4991aa613be79.dir
      size: 639784
      nfiles: 2
    - path: 
        results/sim/moons/conditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 73813a271ac2433995827a50fb8ad808
      size: 30
  eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 1f8d182d1f934519d95c19bf5bdb6fbd
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 112029cd7b8e3b2d8005017a7f2f19ac.dir
      size: 611230
      nfiles: 2
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 6a1a3edde7aec0ecf41aef1d49bf7ab2
      size: 29
  eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7e0daffcacaa3744bfe55f85c970bd26
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b7641430f0c17e8a95ba3ebfd0b36a09.dir
      size: 650924
      nfiles: 2
    - path: 
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 74c17e7340ed93da0fd25288e97defb7
      size: 30
  eval-sim@dataset0-conditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset0-conditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: df91f319469a53c3739793fc7b51a6c9
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 8e05fe79d15549e16eead8547029fdcb.dir
      size: 599987
      nfiles: 2
    - path: results/sim/moons/conditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: f3c14b88aeb5841567585e7b300b3d21
      size: 30
  eval-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 9d20cbc285e9730ca580f8f9ee9c86be
      size: 13944
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 38434bc63a039497ab9150183b903e04.dir
      size: 3133784
      nfiles: 8
    - path: 
        results/sim/moons/conditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: fb41f1047590ec4560f2b1f8f00edec7
      size: 30
  eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 751d439fb4cc605f62efd40cf192d623
      size: 4547696
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: b0ab022ea5c4ccb3697ed02ed8c0a785.dir
      size: 3150693
      nfiles: 8
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 799883fc64f71e8629af48ee93dabe7f
      size: 31
  eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 83360aac50bd20d363aa95f83e938891
      size: 1124088
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
    outs:
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: cab5e87ba838204809b2edcd299409d8.dir
      size: 3195654
      nfiles: 8
    - path: 
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 903882d93218e7ebd82006761c08047f
      size: 31
  eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 6c2171e0abf7aee4ef7912af739c446e
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 849678b302dac775b3364148375fdb6c.dir
      size: 608867
      nfiles: 2
    - path: 
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: c1da6dff43567b2ae755922b605a849c
      size: 30
  eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 209da26cdfdd33d2e8136c5bc5c9783a
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 2e6786855c8fac2f4e8e2a2d768d3a29.dir
      size: 634042
      nfiles: 2
    - path: 
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: d4678c8dd5bbbb3aa92b73bef4d801c5
      size: 29
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 1f8d182d1f934519d95c19bf5bdb6fbd
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 1c7e91debd2afe99a30cad26a0d33f96.dir
      size: 611230
      nfiles: 2
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 6a1a3edde7aec0ecf41aef1d49bf7ab2
      size: 29
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7e0daffcacaa3744bfe55f85c970bd26
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 2d8e7499459e2beecf03647932429942.dir
      size: 665479
      nfiles: 2
    - path: 
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 74c17e7340ed93da0fd25288e97defb7
      size: 30
  eval-sim@dataset0-unconditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset0-unconditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 650a45520e6bb4b049ffc30bb4afd958
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 3e63fb40abb7d785297d806ba023475b.dir
      size: 598703
      nfiles: 2
    - path: results/sim/moons/unconditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: f3aa7ef3dacff30fb01faea919893e5e
      size: 30
  eval-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: c6a68e1e420ef38df494927933b000b1
      size: 13672
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: abba91cc2c15cc2400bc743b25f16da7.dir
      size: 3106804
      nfiles: 8
    - path: 
        results/sim/moons/unconditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: 2338f9f968b76027ac773350c18f4da1
      size: 30
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: d43978145ec3900d3ed87af9f2cfc28f
      size: 27005304
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: c4655ffa31696b6712790d833f36d0cf.dir
      size: 3099461
      nfiles: 8
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 557e0d6c0b92ee90be2adbed948268c7
      size: 30
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: e0a831371e4207ea55799dba61089943
      size: 565208
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: f5c3ebe20b4e312970abea1eaa78ccab.dir
      size: 3107375
      nfiles: 8
    - path: 
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: fe45fbf34743313dce1fe75cc87d987b
      size: 30
  eval-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 4ea924d7b24ad54e82e26ecdf88c676e
      size: 3498008
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 9594bbac91fbdf96005ccbc192935da1.dir
      size: 619161
      nfiles: 2
    - path: 
        results/sim/circles/conditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 2e3e07d6c483b57fcc12a91c270f29d3
      size: 29
  eval-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 152d7c8d3f53c804c0f0a532b972efe0
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape: 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b019191d0919e89a1ff38ef6e8c1c24d.dir
      size: 659082
      nfiles: 2
    - path: 
        results/sim/circles/conditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: ccfd9d74efc6fe38399cebc32634540b
      size: 29
  eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32f65d06ff0a45f7e6d63f96a4051404
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 779088aa97d9e8ad67da0c299c4ccb94.dir
      size: 618961
      nfiles: 2
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: b9d0137816ae1dd110712994cac2b6bb
      size: 30
  eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3d1d0a2a7909df73e2c3e54f45cc2b99
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape: 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 4cc84a0124d026f720972fcdf7e52903.dir
      size: 670485
      nfiles: 2
    - path: 
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 5112f11b320ee2623e94bff20918bfae
      size: 29
  eval-sim@dataset1-conditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset1-conditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 07fc24f13dcfc2358f5c9cdf24e7d30d
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape: 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: abe5554a7033772636f9072bb130fd61.dir
      size: 618412
      nfiles: 2
    - path: results/sim/circles/conditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: e21df1105e6677207f927c528cf9582b
      size: 30
  eval-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 262ed9980b1fcf733c958d11c9456140
      size: 13944
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape: 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 59ead00815d90bb6eb04a9acb45ce2c3.dir
      size: 3145694
      nfiles: 8
    - path: 
        results/sim/circles/conditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: 8c44aa6ef9a09a657c99718dbc16d5b0
      size: 30
  eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8ea68203de5dbca47279cb8783999724
      size: 7941280
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: d211823f3d704213a6221f582eb2687a.dir
      size: 3145091
      nfiles: 8
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 25a19f5285dcf8af219b27872b013632
      size: 30
  eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: ff90f8f277a5f7a6bae14b8ec80b03dc
      size: 1124088
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape: 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape: 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 7cee754175fa924573538d22af0a07a3.dir
      size: 3148079
      nfiles: 8
    - path: 
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 6c0c384660eea22ac0645ffd3b5db088
      size: 31
  eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 400f9878a61628148ba1ce8ae31ee201
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: c1f626d0131de5973358f7c11a0385bf.dir
      size: 616796
      nfiles: 2
    - path: 
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 3bbe472ea18b54b31fb04068ca98d0a9
      size: 29
  eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 8356387e72eec8b6a88cc1306367e90d
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: f5e0af67e4fbf6f38a5516ccd7741f7f.dir
      size: 672457
      nfiles: 2
    - path: 
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 63ff22389c8d29b6c6ae260e4762ce55
      size: 30
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3d1d0a2a7909df73e2c3e54f45cc2b99
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b40aef800ed19edf0cf31df4350a477d.dir
      size: 667223
      nfiles: 2
    - path: 
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 5112f11b320ee2623e94bff20918bfae
      size: 29
  eval-sim@dataset1-unconditional_multivariate_normal:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset1-unconditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: ce7379f12ee9558485df2fe7fa0e6875
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: df36d80dca435123dd7b1a3cdb6d85ab.dir
      size: 617685
      nfiles: 2
    - path: results/sim/circles/unconditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: 3304a103caefff5c9a5d03cb4a024be6
      size: 30
  eval-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: cd11ba273001417075ae5ecb8a0b8bd7
      size: 13672
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: c9eb68a9d282473257f214a79babd495.dir
      size: 3127147
      nfiles: 8
    - path: 
        results/sim/circles/unconditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: 5576c7fa690842fc4c828d9bb0b025b5
      size: 30
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 96cd95e3703a941aa9313a9d0d3381c2
      size: 19085448
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 06dd1f6e4834adb033efe3fc9bcd61c1.dir
      size: 3136003
      nfiles: 8
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: b3e2f530ce4dbcbf13172bf52ccf279f
      size: 30
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3e4fb8e8e0d54955dccbd5a73c1ea60d
      size: 565208
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: f510f13547a070db018163da4d60a773
      size: 13768
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: true
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: abb9f8c591a918b89f2ac6099fba64e3.dir
      size: 3139559
      nfiles: 8
    - path: 
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: d14d86225ef5b277546dca57d6adf6de
      size: 29
  train-benchmark@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: srun --partition=gpu1 --gres=gpu:1 --mem=256GB --export=ALL,MLFLOW_TRACKING_URI=http://login1:5000  python
      scripts/train.py --log-level info --log-file train.log --model-name unconditional_masked_autoregressive_flow_quadratic_spline
      --stage-name 
      train-benchmark@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type benchmark --dataset-name bsds300 --results-path results/ --test-mode
      true --experiment-name train-benchmark
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: 9f6b323a9f3c1417548e88585890e2bb
      size: 2185
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/benchmark.py
      hash: md5
      md5: 35b64b907f68bfc9c8cc2f2846f8172f
      size: 2884
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: 89bc65603be6390bf752d27d47e39317
      size: 48255
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: e19e5322185ca8b0ca12ea054aa302b9
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: 0dd497e85ee923919fa423a93e4d6289
      size: 14090
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: datasets/benchmark/bsds300_train.npy
      hash: md5
      md5: 10d58c2a7b77aafde3461874f48c1f1d
      size: 252000128
    - path: datasets/benchmark/bsds300_validate.npy
      hash: md5
      md5: e9fcc5f84740aa2ee46be1e58fe07962
      size: 12600128
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        log-level: info
        seed: 1
        textwidth: 487.8225
      params/benchmark/bsds300/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs: {}
        fit_kwargs:
          batch_size: 4096
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          early_stopping: 30
          verbose: true
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 10
          use_invertible_linear_transformations: true
          random_permutation_seed: 1
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -3
          parameters_constraint_fn_kwargs:
            interval_width: 6
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 8
          num_parameters: 23
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 512
            - 512
      params/benchmark/dataset.yaml:
        dataset_kwargs.bsds300*:
          scale: 0.537
          shift: 0.914
    outs:
    - path: 
        results/benchmark/bsds300/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: c43b37e2cde2a48a2f10a6a89108dd61
      size: 56
    - path: 
        results/benchmark/bsds300/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: ceeaec439f03ea1e3f8d651a05aab3f4
      size: 125219632
    - path: 
        results/benchmark/bsds300/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 4707e8a56d728fb4fec53ef963cc5111
      size: 13420
