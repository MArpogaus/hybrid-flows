schema: '2.0'
stages:
  train-sim@dataset0-conditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_normal --stage-name train-sim@dataset0-conditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape:
            - 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: bd25a0f738c93559d45bab58c6b004db
      size: 319809
    - path: results/sim/moons/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: bf4271b3ebfd06341adedae675d1cfcd
      size: 55
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: fefa306d30b1ce2329ddb980bfdf9999
      size: 55560
    - path: results/sim/moons/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 2549676ed77dbe1295fee89d2057c385
      size: 278778
    - path: results/sim/moons/conditional_multivariate_normal/train.log
      hash: md5
      md5: 534cff25f8252219cf7373d554842fd0
      size: 2312
  train-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: ee26f3b5a6c5e39109cfa0bf0b53e279
      size: 319809
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 597e252f3fdc66daa10b0c9126827363
      size: 55
    - path:
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: ed40235af30f5121eaaebae1d0f8a660
      size: 2228400
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: b208c30ab08358aa7b29c3738599d86a
      size: 274458
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 7999a1a243030adc4fcc13b6f77a6a90
      size: 5375
  eval-sim@dataset0-conditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset0-conditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/moons/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: fefa306d30b1ce2329ddb980bfdf9999
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape:
            - 1
            dropout: 0
            hidden_units:
            - 16
            - 16
    outs:
    - path: results/sim/moons/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 6dfd788edebfb8e0ba1f25bda131a2a9.dir
      size: 804822
      nfiles: 2
    - path: results/sim/moons/conditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: e7cc272c9fa36735db1b8ff6d8a4134f
      size: 31
  train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 0af7732f718ee88a28215242d5451164
      size: 319809
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 3ab6aa0c43edf7f8b59b98757b85c06b
      size: 52
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7b5a31aa197fe23f0f8a410e30c108e6
      size: 1418896
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 171c8aebbbe6236759d1be022a571265
      size: 299236
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 2b0043690a86457ce392e08b14cb113f
      size: 5079
  eval-sim@dataset0-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: ed40235af30f5121eaaebae1d0f8a660
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: f3478e7c1467ddacac9423f817a1f3b9.dir
      size: 804401
      nfiles: 2
    - path:
        results/sim/moons/conditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 02caeca922b12f6ef26551f9611803c8
      size: 31
  eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7b5a31aa197fe23f0f8a410e30c108e6
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: ee22b1743cf69344b2fbb016e347db61.dir
      size: 832414
      nfiles: 2
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: e9ec71d1756463de139e310fa37997db
      size: 31
  train-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_transformation_model --stage-name train-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: d2ae67195622cc1e08ecfd16d59ad733
      size: 319809
    - path: results/sim/moons/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 465481f09d0bf786279452e7b25c5f88
      size: 55
    - path:
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: f039020eb332cf82573e19b92bc62cb0
      size: 13944
    - path: results/sim/moons/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 7728e4a22b2ce40e9f0c027d09892f43
      size: 277015
    - path: results/sim/moons/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 066c0d1c2a81f9e0938abcd94d14807f
      size: 5325
  train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: a47b42dd23f17074eee34c219a18be8a
      size: 319809
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 6dc3889e334373d20532828c446648b9
      size: 56
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36ee41eb084c69c2aa4bc18dce1e522f
      size: 1622704
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 17412e7666d6a0d08722c451b3905c97
      size: 278304
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: ee7271b3f1c3ab898715f138d328efa5
      size: 5327
  eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36ee41eb084c69c2aa4bc18dce1e522f
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 8bba9681f304871a56b84419437aa1f8.dir
      size: 807689
      nfiles: 2
    - path:
        results/sim/moons/conditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: bd614910b702d0bd91105b3d7d4d97f0
      size: 31
  eval-sim@dataset0-conditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset0-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: f039020eb332cf82573e19b92bc62cb0
      size: 13944
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: f3c0d83639a85579cc8ef3a8f543fcd1.dir
      size: 4296686
      nfiles: 8
    - path:
        results/sim/moons/conditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: f4568e46adadb8724188fe0c61008623
      size: 31
  train-sim@dataset0-unconditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_normal --stage-name train-sim@dataset0-unconditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: b2b74e3227196a66aa9bade97add57d8
      size: 319809
    - path: results/sim/moons/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 2463a453e603e0dbf0b5770901027fb1
      size: 58
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 09400f4a77c5804849303f332a0310a4
      size: 11000
    - path: results/sim/moons/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 04bba21461cec80a6a2665ab044b93f1
      size: 303588
    - path: results/sim/moons/unconditional_multivariate_normal/train.log
      hash: md5
      md5: 67deb63f4182e4cc5613bc19d8782c50
      size: 1851
  train-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 391b53cf485addba0ab2c5ac4ad21620
      size: 319809
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: ced9e681887103b388ef96366f41165a
      size: 56
    - path:
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: aae89cf6ead823190f57d81f1a4d41ae
      size: 1752808
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 69ad9a83bae353c5ceecfa633b91ba3d
      size: 300130
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 0e26ec793f17a67f04cf4b5534d50d40
      size: 5437
  eval-sim@dataset0-unconditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset0-unconditional_multivariate_normal
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/moons/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 09400f4a77c5804849303f332a0310a4
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
    outs:
    - path: results/sim/moons/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: ece839de764d3b873325cd7344f106ab.dir
      size: 796071
      nfiles: 2
    - path: results/sim/moons/unconditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: 93a665b4038b0fce130aeffba614c66d
      size: 32
  train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 40aab29a6eda0cb5b5c27ee667f01e61
      size: 319809
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 9c502bdefe09130620daa3d3cf373017
      size: 56
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: cca026cd6ef5b81ba943ce69679794ad
      size: 4547696
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 2133a24e3185e54353dbf8b8619bd3a6
      size: 308722
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 39933cfb9484a0b607b1287814e216c4
      size: 6166
  train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 9ebd3ffb358647a722fac5191a5f8933
      size: 319809
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 3ab6aa0c43edf7f8b59b98757b85c06b
      size: 52
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7b5a31aa197fe23f0f8a410e30c108e6
      size: 1418896
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 3d085a1ae153a99bb9265e87bf251973
      size: 299236
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 2598eb826633ee65f30eac23458ea275
      size: 4726
  eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: aae89cf6ead823190f57d81f1a4d41ae
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: f6681f6798678039ea5871d5c121e758.dir
      size: 841773
      nfiles: 2
    - path:
        results/sim/moons/unconditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 30688609742b61f8753eefa4e038811c
      size: 31
  train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: d64b0433b4ad54c25de78dd56281d582
      size: 319809
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 6dc3889e334373d20532828c446648b9
      size: 56
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36ee41eb084c69c2aa4bc18dce1e522f
      size: 1622704
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: f3df004bda001df7276a32a1f3565c1f
      size: 278304
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 44e2ff5757adf4b4d5d4e9e5d8a907d3
      size: 4974
  train-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: fd9ad1bfd8fb4c06e9230ca386b5ba47
      size: 319809
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: f0966506282472a98f41f0611fcc25bf
      size: 56
    - path:
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 4e29942b56e9425fe9b246df8bb2edea
      size: 1119168
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 758454d157b95774c99aeb7c1346b3e3
      size: 284776
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 8c0bc1d33d4fa1a0d87e1fc81fbb4798
      size: 5025
  train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 3abfc3a63c200933bdd97475d709aa36
      size: 319809
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 08049a96432c301c892d22f8360cbdd9
      size: 56
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 1d11641df5b6c5a0799c5621f3168d42
      size: 1124088
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 3fdedd68a9747de21be9f0d970b1f8bc
      size: 307016
    - path: results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: e2938d670c25d5458dfd9ec5976a1d5d
      size: 5768
  train-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_transformation_model --stage-name train-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 0d6689491e5e4dd6ac8b470a22939302
      size: 319809
    - path: results/sim/moons/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: 9c0c404520467d31e27bc84d62171878
      size: 55
    - path:
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 0e76926126147804b6c6686ce700a6df
      size: 13672
    - path: results/sim/moons/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 3d7e19e0c9c4853ad2c07cf557b5fa59
      size: 297386
    - path: results/sim/moons/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 9859181c5596bbc6646fdf6faf6aee9b
      size: 4116
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 7b5a31aa197fe23f0f8a410e30c108e6
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 32d5a06335a05a47f60823e3fc5c1361.dir
      size: 832414
      nfiles: 2
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: e9ec71d1756463de139e310fa37997db
      size: 31
  eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 36ee41eb084c69c2aa4bc18dce1e522f
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 201c74c63c112f7dc3d613ff19ebc77a.dir
      size: 807689
      nfiles: 2
    - path:
        results/sim/moons/unconditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: bd614910b702d0bd91105b3d7d4d97f0
      size: 31
  eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 4e29942b56e9425fe9b246df8bb2edea
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
    outs:
    - path: results/sim/moons/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 0a9d84059568303d4bd37da8eda31bdb.dir
      size: 817834
      nfiles: 2
    - path:
        results/sim/moons/unconditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 10e2bb5d5f656c5555f5440321592d05
      size: 31
  train-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: ee26f3b5a6c5e39109cfa0bf0b53e279
      size: 319809
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 5933cc7365cf22e9438725b56ceafbdd
      size: 55
    - path:
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c238308e1667ba162c0b655a3e8d78f3
      size: 3498008
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 006e0d58618c990f55bec4e151b0d878
      size: 306566
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 3c165b343b7016fd6e9f321c2749ef8b
      size: 5791
  eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: cca026cd6ef5b81ba943ce69679794ad
      size: 4547696
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 512
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 300
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
    outs:
    - path: results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 3eece7ff90e6c264848d7a57cda7f640.dir
      size: 4396965
      nfiles: 8
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 091cc5a44698990f94ad4297db6754ca
      size: 31
  eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 1d11641df5b6c5a0799c5621f3168d42
      size: 1124088
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 1789f4cedfab59a3a2f681bf5fae158a.dir
      size: 4397728
      nfiles: 8
    - path:
        results/sim/moons/conditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 9efabb159e4deb2817ebc2b6d90ddb8c
      size: 31
  eval-sim@dataset0-unconditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset0-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 0e76926126147804b6c6686ce700a6df
      size: 13672
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 93d7f3693534b464e3720e92875781d3.dir
      size: 4332601
      nfiles: 8
    - path:
        results/sim/moons/unconditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: 321f12597807d54e123686d14a80e1ca
      size: 31
  eval-sim@dataset0-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: c238308e1667ba162c0b655a3e8d78f3
      size: 3498008
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
    outs:
    - path: results/sim/moons/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 0ee4cb764c1b14ccdde847fad1803f24.dir
      size: 838758
      nfiles: 2
    - path:
        results/sim/moons/conditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: a85416a7ae3e1d426b9e999d4db76e04
      size: 31
  train-sim@dataset1-conditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_normal --stage-name train-sim@dataset1-conditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape:
            - 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 094b5f697b59dc2f5ab16e4fcf7c251c
      size: 320943
    - path: results/sim/circles/conditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 7be848cefecb4735ef384ed9832a2865
      size: 56
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 1b6ee491cf03e29619e592fcbb03df7a
      size: 55560
    - path: results/sim/circles/conditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 60b0c0ef30f5b06d23b533ce41580598
      size: 300948
    - path: results/sim/circles/conditional_multivariate_normal/train.log
      hash: md5
      md5: 0c51883c3816db7333b962aa06bcfe30
      size: 2368
  train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a297d17fe2f3cd5e534afbe992888c57
      size: 319809
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 684b75b8a4a2c4b96c2f7f95f4b103cf
      size: 55
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: becac1f974a7d72e025b75fa4854f0f4
      size: 565208
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: ae889f82f3be8e0bbaecc5d024fbf881
      size: 306188
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 81e4889bc33dc6578904d85fe970644b
      size: 5503
  eval-sim@dataset1-conditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_normal --stage-name eval-sim@dataset1-conditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: results/sim/circles/conditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 1b6ee491cf03e29619e592fcbb03df7a
      size: 55560
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            activation: relu
            batch_norm: true
            conditional: true
            conditional_event_shape:
            - 1
            dropout: 0
            hidden_units:
            - 16
            - 16
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 29fdf9145120de121e630a655dd6ab0e.dir
      size: 794312
      nfiles: 2
    - path: results/sim/circles/conditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: d2cc94acb5b85ddeb0979fb8478ecef3
      size: 31
  train-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_multivariate_transformation_model --stage-name train-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: a1010ff7317f9c3f2d77499c16dbc61d
      size: 320943
    - path: results/sim/circles/conditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: c7263715243699f131fe403939b05a53
      size: 56
    - path:
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 840244a7eb99750b88ad6a0c19e27abe
      size: 13944
    - path: results/sim/circles/conditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 954a8bba484ed926f0211553866d690e
      size: 289557
    - path: results/sim/circles/conditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 1d1d8b56bc1256199227a426e3827a0f
      size: 5378
  train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: c8d7c5810c57715018a1a5a2bd58ab88
      size: 320943
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 35380baeab2b301559c3d22967a61a10
      size: 56
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 08ae705a307820109576a0126e1b9061
      size: 1418896
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 2b913d1f3641f259d235c4b3c349c716
      size: 278632
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 5a8f744730a73a847f21feb3d4ce7c94
      size: 5138
  eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 08ae705a307820109576a0126e1b9061
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 0a7d8738ed8e6e1f7c2225e593a18685.dir
      size: 832861
      nfiles: 2
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: bf1cbe513cad05d0f7b2e5937b05f92c
      size: 31
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: becac1f974a7d72e025b75fa4854f0f4
      size: 565208
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b7bec72a65297636ffed348becd26733.dir
      size: 4423871
      nfiles: 8
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: d4e3c3924a123f0e647854749e0c2687
      size: 31
  eval-sim@dataset1-conditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_multivariate_transformation_model --stage-name eval-sim@dataset1-conditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 840244a7eb99750b88ad6a0c19e27abe
      size: 13944
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 30
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          - bijector: Shift
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 2
              polynomial_order: 6
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              conditional_event_shape:
              - 1
              dtype: float32
              extrapolation: true
              parameter_shape:
              - 1
              polynomial_order: 3
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 16c8011c5d9bedcc8e8a0e67d603145f.dir
      size: 4428142
      nfiles: 8
    - path:
        results/sim/circles/conditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: da8bd86ee7218aa36d1b957153f0c9b5
      size: 32
  train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 08887a5675daf7c16309189139614ff7
      size: 320943
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 250700dc7f7fd9da2679b4a9be045134
      size: 56
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: e7df7e912ca3f36fb6c9519649a079a9
      size: 1622704
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 6439e05672ff5f6c09339452d89d4123
      size: 286338
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 15876d40de21602e649c79c0c55981c5
      size: 5382
  eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: e7df7e912ca3f36fb6c9519649a079a9
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            conditional: true
            conditional_event_shape:
            - 1
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 28fafaa3d09e063c90ed264a1b111be4.dir
      size: 870832
      nfiles: 2
    - path:
        results/sim/circles/conditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: b132e6ceb9a2c30337295dccd875b3c8
      size: 31
  train-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 40e48e43a3b67c20afc94f84dc98d096
      size: 320943
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: c1c33b853f0f7524bade941dd2aa8435
      size: 55
    - path:
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: ff99e85cba47f93a6c1c0ced3047dbe0
      size: 3498008
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: e2bd3cea52b561bfa63d129c56406683
      size: 301139
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: d4e2ce3ed315487d2c631fbc80e5f149
      size: 5845
  eval-sim@dataset1-conditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: ff99e85cba47f93a6c1c0ced3047dbe0
      size: 3498008
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 073881a3f0e3a23762d1cbecb5fdd3f4.dir
      size: 868909
      nfiles: 2
    - path:
        results/sim/circles/conditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 8b683cc6fc65a5290d0e5f433fc2fd71
      size: 30
  train-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: e114e9071b0fad799741758a180ad0ca
      size: 320943
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 5271dacc1a15c04b6c6042a4a31ec594
      size: 56
    - path:
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 932816ab3f7ca0e2dbd7ee3fccf1f5f3
      size: 1752808
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: ff21050cad3d07da73422579b438847b
      size: 289079
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: a9b2622cca9032fe97c07a8c2b6ff52d
      size: 5492
  train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: f078e0fc38c56d1b54245f896a5b0fab
      size: 320943
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 35380baeab2b301559c3d22967a61a10
      size: 56
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 08ae705a307820109576a0126e1b9061
      size: 1418896
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: e1821a10a2822d3388dea6e6ec9a84a5
      size: 278632
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/train.log
      hash: md5
      md5: 58a5f839016ba99866ad515e96784782
      size: 4785
  eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 932816ab3f7ca0e2dbd7ee3fccf1f5f3
      size: 1752808
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - 0
            - 1
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: 0
            high: 1
          num_parameters: 300
          layer_overwrites:
            -2:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
            -1:
              parameters_constraint_fn_kwargs:
                low: -5
                high: 5
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 7d9a93ce330f959b769b7aef43d084d9.dir
      size: 795912
      nfiles: 2
    - path:
        results/sim/circles/unconditional_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: e5a1b3448fb77b44b3758e96c9ab62a0
      size: 31
  train-sim@dataset1-unconditional_multivariate_normal:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_normal --stage-name train-sim@dataset1-unconditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/dataset.pdf
      hash: md5
      md5: 2bcf0569cc560c37bded0bc8ac9b8b9d
      size: 320943
    - path: results/sim/circles/unconditional_multivariate_normal/metrics.yaml
      hash: md5
      md5: 50f3401f4d911561973dc8941d4724f4
      size: 58
    - path:
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 221732f18f7398df910df14e207e2e65
      size: 11000
    - path: results/sim/circles/unconditional_multivariate_normal/samples.pdf
      hash: md5
      md5: 6741a30e825ab7036d1082080bdab5a7
      size: 274096
    - path: results/sim/circles/unconditional_multivariate_normal/train.log
      hash: md5
      md5: 554cee667a8beda9578f5168efafb1e2
      size: 1906
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 08ae705a307820109576a0126e1b9061
      size: 1418896
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: b254540b51ffbec64d27afb4b409e713.dir
      size: 832861
      nfiles: 2
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: bf1cbe513cad05d0f7b2e5937b05f92c
      size: 31
  train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 85aeeac8d480542614ca595d08c9123d
      size: 320943
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 250700dc7f7fd9da2679b4a9be045134
      size: 56
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: e7df7e912ca3f36fb6c9519649a079a9
      size: 1622704
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 88b1ff343d8c869f4947b311754df4d3
      size: 286338
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/train.log
      hash: md5
      md5: 9d73db3b4fafc95411d3cba387b63119
      size: 5029
  eval-sim@dataset1-unconditional_multivariate_normal:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_normal --stage-name eval-sim@dataset1-unconditional_multivariate_normal
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_multivariate_normal/model_checkpoint.weights.h5
      hash: md5
      md5: 221732f18f7398df910df14e207e2e65
      size: 11000
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_normal.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          batch_size: 256
          early_stopping: false
          epochs: 200
          learning_rate:
            scheduler_kwargs:
              decay_steps: 200
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          monitor: val_loss
          reduce_lr_on_plateau: false
          validation_split: 0.1
          verbose: true
        model_kwargs:
          distribution: multivariate_normal
          parameters_fn_kwargs:
            conditional: false
            dtype: float32
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_normal/eval_figures/
      hash: md5
      md5: 8438aa4e91a51c7b9e4463e8db7b1e17.dir
      size: 807680
      nfiles: 2
    - path: results/sim/circles/unconditional_multivariate_normal/evaluation_metrics.yaml
      hash: md5
      md5: 3ec677a58b9fb11a89ec05a41e905a91
      size: 32
  train-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_multivariate_transformation_model --stage-name train-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_multivariate_transformation_model/dataset.pdf
      hash: md5
      md5: 0b8a7f55ed38a3311bf12ddff409589a
      size: 320943
    - path: results/sim/circles/unconditional_multivariate_transformation_model/metrics.yaml
      hash: md5
      md5: dded58dd285424bf13618919575e777f
      size: 56
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 9b8449a4e4cddcc9ea8018a9e74b9efb
      size: 13672
    - path: results/sim/circles/unconditional_multivariate_transformation_model/samples.pdf
      hash: md5
      md5: 7d36de574d886ba82ff956317c66ed2f
      size: 289835
    - path: results/sim/circles/unconditional_multivariate_transformation_model/train.log
      hash: md5
      md5: 87389572f9d0ab8e3990501066a4cf37
      size: 3973
  eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_masked_autoregressive_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_masked_autoregressive_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: e7df7e912ca3f36fb6c9519649a079a9
      size: 1622704
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: masked_autoregressive_flow
          num_layers: 2
          bijector: BernsteinPolynomial
          bijector_kwargs:
            extrapolation: false
            domain:
            - -5
            - 5
          invert: true
          parameters_constraint_fn_kwargs:
            allow_flexible_bounds: false
            bounds: linear
            low: -5
            high: 5
          num_parameters: 128
          layer_overwrites:
            0:
              bijector_kwargs:
                domain:
                - 0
                - 1
          parameters_fn_kwargs:
            activation: relu
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: fa39c5d0e1eb44d90f5e37690a046a50.dir
      size: 852359
      nfiles: 2
    - path:
        results/sim/circles/unconditional_masked_autoregressive_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: b132e6ceb9a2c30337295dccd875b3c8
      size: 31
  train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 687b5c3839531515f39bb6c82d5335cd
      size: 320943
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 9da30addffb5bafc2337082536fb1954
      size: 56
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: cf47eb6e2c45b18fdf1ea17b9bd9c76d
      size: 1124088
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: f52bd198d7d79bacb7c733a18071728e
      size: 310006
    - path: results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: cd9cbb125508e13348834259ecc37a21
      size: 5819
  eval-sim@dataset1-unconditional_multivariate_transformation_model:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_multivariate_transformation_model --stage-name eval-sim@dataset1-unconditional_multivariate_transformation_model
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/model_checkpoint.weights.h5
      hash: md5
      md5: 9b8449a4e4cddcc9ea8018a9e74b9efb
      size: 13672
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_multivariate_transformation_model.yaml:
        compile_kwargs: {}
        fit_kwargs:
          epochs: 100
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: 100
              initial_learning_rate: 0.01
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: false
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: true
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: smooth
              high: 4
              low: -4
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: ScaleMatvecLinearOperator
            invert: true
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 1
              - 1
            parameters_constraint_fn: hybrid_flows.activations.lambda_parameters_constraint_fn
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/eval_figures/
      hash: md5
      md5: 7c3288d3ac75b3922cbccde06221b92d.dir
      size: 4425485
      nfiles: 8
    - path:
        results/sim/circles/unconditional_multivariate_transformation_model/evaluation_metrics.yaml
      hash: md5
      md5: a05e4a0106ef9bedb3c80741d29a5d85
      size: 31
  eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: cf47eb6e2c45b18fdf1ea17b9bd9c76d
      size: 1124088
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: baf48cee52dd1bf285c901b303f3f591.dir
      size: 4440213
      nfiles: 8
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 70d6b0b125e3084057c3b46b1299a5ba
      size: 31
  train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 6468ba404119cb1ff420940985640df5
      size: 319809
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 0f591381f797da5edd94646fad4494ea
      size: 56
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: ec19f30425d8e023d95d4328dbe2731a
      size: 27005304
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: e587cecf86c89900395b52a4f0803d06
      size: 305391
    - path: results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 120de32576eea6d2ed0eb6c07d1fa951
      size: 5708
  train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 2498f07173154b1ec9f21a5b1aae2ef4
      size: 320943
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 92e5da307f9ded62ebdba211a5318419
      size: 55
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: b184580be8d11976ea81c28f568e6f38
      size: 565208
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 68753d254290634d5ce02a8567196c89
      size: 313516
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: 12371594cc2116c366ab87a21115b2f5
      size: 5557
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: b184580be8d11976ea81c28f568e6f38
      size: 565208
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: RationalQuadraticSpline
              bijector_kwargs:
                range_min: -5
              parameters_constraint_fn_kwargs:
                interval_width: 10
                min_slope: 0.001
                min_bin_width: 0.001
                nbins: 32
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 128
              - 128
              - 128
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 95
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 72d9cdff2a2aea2365d7c709d352745a.dir
      size: 4522160
      nfiles: 8
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 2bc079b939c4ba597722209e9a55483a
      size: 31
  eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset0-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name moons --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: ec19f30425d8e023d95d4328dbe2731a
      size: 27005304
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/dataset.yaml:
        dataset_kwargs.moons*:
          n_samples: 16384
          noise: 0.05
          scale:
          - 0.05
          - 0.95
          random_state: 1
      params/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 128
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 2000
        two_stage_training: true
    outs:
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: ea3104cfb2840041d482a679b823b9fd.dir
      size: 4422840
      nfiles: 8
    - path:
        results/sim/moons/unconditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 19dd696bbecfc02b36eeaf5353faeba9
      size: 31
  train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 74674abcceebf71861bdd84a2acbff73
      size: 320943
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: 35acc62818991c5432091fc1615e4b37
      size: 56
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32c3fac83346e71a92448062fe04e941
      size: 19085448
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 50ca1d030ff7bd95149d509e77319f1a
      size: 301093
    - path: results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 4bc2fbfef23ce6bf0a12f6a6d6f5e864
      size: 5759
  eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-unconditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 32c3fac83346e71a92448062fe04e941
      size: 19085448
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: false
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: parameter_vector
            parameters_fn_kwargs:
              dtype: float32
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 32
              - 1024
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 69ff53a633f89d24c882098fb6349678.dir
      size: 4492337
      nfiles: 8
    - path:
        results/sim/circles/unconditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 4f836437e050493ca5c6ad2633c87eef
      size: 31
  train-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: 6dc62576d086fb4c04af8af26fed72b2
      size: 320943
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: 8b5b50676923b9735e4103fd60428c05
      size: 55
    - path:
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3ce0f61393474f5ee2d6e356c75426e0
      size: 2228400
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 5f011ca738de025eb8cf346d5a6a8593
      size: 279498
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: dae48a4bf6b8f8483c681823ed114586
      size: 5432
  train-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name train-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/dataset.pdf
      hash: md5
      md5: a15887c870043b12fc5ee009ec16eb8f
      size: 320943
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/metrics.yaml
      hash: md5
      md5: da0be3cde82c2ec7c66b8994f05e5523
      size: 56
    - path:
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: fa1f8226bbcd3097236a07b67244bc2c
      size: 1119168
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/samples.pdf
      hash: md5
      md5: 512360945c4bf4e1c2b0c09322d2883d
      size: 280201
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/train.log
      hash: md5
      md5: bef4db95093bb825a89df5e8dab2921d
      size: 5080
  eval-sim@dataset1-conditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-conditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: 3ce0f61393474f5ee2d6e356c75426e0
      size: 2228400
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
            conditional: true
            conditional_event_shape:
            - 1
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 1d467ecafbd1bbb4a2b8ab9084a0f6a6.dir
      size: 874888
      nfiles: 2
    - path:
        results/sim/circles/conditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: 2517969a7bb4471babe88ab0e381d76c
      size: 31
  eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      unconditional_coupling_flow_quadratic_spline --stage-name eval-sim@dataset1-unconditional_coupling_flow_quadratic_spline
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/model_checkpoint.weights.h5
      hash: md5
      md5: fa1f8226bbcd3097236a07b67244bc2c
      size: 1119168
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/unconditional_coupling_flow_quadratic_spline.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
          epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          distribution: coupling_flow
          num_layers: 2
          bijector: RationalQuadraticSpline
          bijector_kwargs:
            range_min: -5
          parameters_constraint_fn_kwargs:
            interval_width: 10
            min_slope: 0.001
            min_bin_width: 0.001
            nbins: 32
          num_parameters: 95
          parameters_fn_kwargs:
            activation: relu
            batch_norm: false
            dropout: 0
            hidden_units:
            - 128
            - 128
            - 128
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/unconditional_coupling_flow_quadratic_spline/eval_figures/
      hash: md5
      md5: 562e369cdaa5eb66b39be4ca12b00e99.dir
      size: 832579
      nfiles: 2
    - path:
        results/sim/circles/unconditional_coupling_flow_quadratic_spline/evaluation_metrics.yaml
      hash: md5
      md5: d87df80f917d2c625a9ef8e718f122aa
      size: 31
  train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/train.py --log-level info --log-file train.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name train-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --test-mode
      false --experiment-name train-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/dataset.pdf
      hash: md5
      md5: 898395850eba9aab65f2651e9a2e8991
      size: 320943
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/metrics.yaml
      hash: md5
      md5: b76958bde407d8b598f27bb87813d1d7
      size: 55
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8d3492536b9c2a88b143339067916490
      size: 7941280
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/samples.pdf
      hash: md5
      md5: 38f4417df3a82132c73dbf73991727e5
      size: 307783
    - path: results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/train.log
      hash: md5
      md5: 5b13a4ba0a2e061f68729e1bd1d284c5
      size: 6219
  eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly:
    cmd: python scripts/evaluate_sim.py --log-level info --log-file evaluate.log --model-name
      conditional_hybrid_coupling_flow_bernstein_poly --stage-name eval-sim@dataset1-conditional_hybrid_coupling_flow_bernstein_poly
      --dataset-type sim --dataset-name circles --results-path results/ --experiment-name
      eval-sim
    deps:
    - path: ../pyproject.toml
      hash: md5
      md5: c361f28c1242f701df135d3dac458e84
      size: 2384
    - path: ../src/hybrid_flows/__init__.py
      hash: md5
      md5: 50bfe848b7a3b24849bf3c51890564e5
      size: 54
    - path: ../src/hybrid_flows/activations.py
      hash: md5
      md5: 9a4b52ca62e674d4e873fcf37ac33b1c
      size: 6651
    - path: ../src/hybrid_flows/data/__init__.py
      hash: md5
      md5: db8cab88136ebab93664b848e3e036f8
      size: 3448
    - path: ../src/hybrid_flows/data/sklearn_datasets.py
      hash: md5
      md5: 34d8ecb0a7c6a8d218f9df383cdfeb64
      size: 770
    - path: ../src/hybrid_flows/distributions.py
      hash: md5
      md5: ebe4a5d54e90e07524b1ca596846034f
      size: 48257
    - path: ../src/hybrid_flows/models.py
      hash: md5
      md5: e7fed3c9a67239cdc070cbc0f03ce4b1
      size: 14401
    - path: ../src/hybrid_flows/nn.py
      hash: md5
      md5: 552aec4f1c0b19132292be2146a68e99
      size: 13279
    - path: ../src/hybrid_flows/parameters.py
      hash: md5
      md5: f3dcd5e2abc934b05b140728ffa5d816
      size: 15301
    - path: ../src/hybrid_flows/preprocessing.py
      hash: md5
      md5: 395dbc40ef7a285ba1f11bb6c974eeb8
      size: 4395
    - path: ../src/hybrid_flows/scheduler.py
      hash: md5
      md5: 968fe1c35be0e11147ab55012795e31c
      size: 4211
    - path: ../src/hybrid_flows/utils/__init__.py
      hash: md5
      md5: e492dadbd5fd819f4e207599e3db2e88
      size: 5196
    - path: ../src/hybrid_flows/utils/decorators.py
      hash: md5
      md5: 4cb2aa8fb69539031cb20b80f3607959
      size: 3478
    - path: ../src/hybrid_flows/utils/mlflow.py
      hash: md5
      md5: 149e1cec02a8171b8b5c5c60fb4cd440
      size: 3819
    - path: ../src/hybrid_flows/utils/pipeline.py
      hash: md5
      md5: 3146f4dcdee978b5a1998ebd6ce0dff1
      size: 11291
    - path: ../src/hybrid_flows/utils/tensorflow.py
      hash: md5
      md5: 0a4f2eec14691c8baa617685b4858871
      size: 5910
    - path: ../src/hybrid_flows/utils/visualisation.py
      hash: md5
      md5: 59397f4b8ef22f40aa0e8831c5a93c9a
      size: 16941
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/model_checkpoint.weights.h5
      hash: md5
      md5: 8d3492536b9c2a88b143339067916490
      size: 7941280
    - path: scripts/evaluate_sim.py
      hash: md5
      md5: 30d880eaf294500bc389aa9e061083ae
      size: 13772
    - path: scripts/train.py
      hash: md5
      md5: 2bf31f9aa7b886b13c22c481467886ab
      size: 10071
    params:
      params.yaml:
        seed: 1
        testmode: false
        textwidth: 487.8225
      params/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly.yaml:
        compile_kwargs:
          jit_compile: true
        fit_kwargs:
        - epochs: 1000
          batch_size: 1024
          learning_rate: 0.05
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        - epochs: 400
          batch_size: 512
          learning_rate:
            scheduler_kwargs:
              decay_steps: epochs
              initial_learning_rate: 0.001
            scheduler_name: cosine_decay
          reduce_lr_on_plateau: false
          early_stopping: 50
          monitor: val_loss
          verbose: true
          validation_split: 0.25
        model_kwargs:
          marginal_bijectors:
          - bijector: BernsteinPolynomial
            invert: true
            bijector_kwargs:
              domain:
              - 0
              - 1
              extrapolation: false
            parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
            parameters_constraint_fn_kwargs:
              allow_flexible_bounds: false
              bounds: linear
              high: 5
              low: -5
            parameters_fn: bernstein_polynomial
            parameters_fn_kwargs:
              dtype: float32
              extrapolation: true
              conditional_event_shape:
              - 1
              polynomial_order: 1
              parameter_shape:
              - 2
              - 300
          joint_bijectors:
          - bijector: RealNVP
            bijector_kwargs:
              num_masked: 1
            nested_bijector:
              bijector: BernsteinPolynomial
              invert: true
              bijector_kwargs:
                domain:
                - -5
                - 5
                extrapolation: false
              parameters_constraint_fn: hybrid_flows.activations.get_thetas_constrain_fn
              parameters_constraint_fn_kwargs:
                allow_flexible_bounds: false
                bounds: linear
                high: 5
                low: -5
              parametrized_by_parent: true
            parameters_fn: fully_connected_network
            parameters_fn_kwargs:
              activation: relu
              batch_norm: false
              dropout: false
              hidden_units:
              - 512
              - 512
              - 32
              dtype: float32
              input_shape:
              - 1
              parameter_shape:
              - 1
              - 1500
              conditional: true
              conditional_event_shape:
              - 1
        two_stage_training: true
      params/sim/dataset.yaml:
        dataset_kwargs.circles*:
          n_samples: 16384
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
          random_state: 1
    outs:
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/eval_figures/
      hash: md5
      md5: 794f572b1d7224a2697835f8857bab66.dir
      size: 4456829
      nfiles: 8
    - path:
        results/sim/circles/conditional_hybrid_coupling_flow_bernstein_poly/evaluation_metrics.yaml
      hash: md5
      md5: 33093c9334dc854dba8f1c39963087c1
      size: 31
