schema: '2.0'
stages:
  download_benchmark_data:
    cmd: python src/mctm/data/benchmark.py | tee datasets/benchmark_stats
    outs:
    - path: datasets/benchmark_stats
      hash: md5
      md5: d2c8e4eeea4465d0bd5e5473f8d6a93a
      size: 9349
    - path: datasets/bsds300/
      hash: md5
      md5: e4ab795c846604419827e750c741c2ce.dir
      size: 327602144
      nfiles: 1
    - path: datasets/data.tar.gz
      hash: md5
      md5: 9b9c9b0375315ad270eba4ce80c093ab
      size: 856664546
    - path: datasets/hepmass/
      hash: md5
      md5: 5e24c498e022d4c8b79714a6065882cf.dir
      size: 750085192
      nfiles: 2
    - path: datasets/miniboone/
      hash: md5
      md5: 5cf3ec51bb664978790c9a45a3531e98.dir
      size: 12551952
      nfiles: 1
    - path: datasets/power/
      hash: md5
      md5: 885e2dbe66f0670d26e959e74be98025.dir
      size: 131154000
      nfiles: 1
  unconditional_benchmark@elementwise_flow-hepmass:
    cmd: python scripts/train_benchmark.py --log-level info --log-file results/unconditional_benchmark_elementwise_flow_hepmass/train.log
      --experiment-name unconditional-benchmark-hepmass unconditional_benchmark@elementwise_flow-hepmass
      elementwise_flow hepmass results/unconditional_benchmark_elementwise_flow_hepmass
      --test-mode=true
    deps:
    - path: datasets/hepmass
      hash: md5
      md5: 5e24c498e022d4c8b79714a6065882cf.dir
      size: 750085192
      nfiles: 2
    - path: pyproject.toml
      hash: md5
      md5: f04546362686cf891a3c1b7df83d1e0b
      size: 1104
    - path: scripts/train.py
      hash: md5
      md5: 916524801990bc4d596d19e635883808
      size: 5431
    - path: src/mctm
      hash: md5
      md5: 1c4d557c6e5dc3341f257a44a062eedb.dir
      size: 80242
      nfiles: 14
    params:
      params.yaml:
        benchmark_datasets.hepmass*: {}
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.elementwise_flow.hepmass*:
          distribution_kwds:
            bijector_name: bernstein_poly
            order: 100
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
            shift: false
            scale: false
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            validation_split:
            batch_size: 32
            lr_patience: 10
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            learning_rate: 0.01
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/mcp
      hash: md5
      md5: 0530413b431d39f8b8051900d4761a31.dir
      size: 26864
      nfiles: 3
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/metrics.yaml
      hash: md5
      md5: 4df4f4661d0b0cbac7fa985d5bfffb5c
      size: 54
    - path: results/unconditional_benchmark_elementwise_flow_hepmass/train.log
      hash: md5
      md5: 9cbe5eef18773d7720417a63e0d6f058
      size: 3589
  unconditional_benchmark@elementwise_flow-miniboone:
    cmd: python scripts/train_benchmark.py --log-level info --log-file results/unconditional_benchmark_elementwise_flow_miniboone/train.log
      --experiment-name unconditional-benchmark-miniboone unconditional_benchmark@elementwise_flow-miniboone
      elementwise_flow miniboone results/unconditional_benchmark_elementwise_flow_miniboone
      --test-mode=true
    deps:
    - path: datasets/miniboone
      hash: md5
      md5: 5cf3ec51bb664978790c9a45a3531e98.dir
      size: 12551952
      nfiles: 1
    - path: pyproject.toml
      hash: md5
      md5: f04546362686cf891a3c1b7df83d1e0b
      size: 1104
    - path: scripts/train.py
      hash: md5
      md5: 916524801990bc4d596d19e635883808
      size: 5431
    - path: src/mctm
      hash: md5
      md5: dcfe538d7edb930e60022986f36286f5.dir
      size: 80187
      nfiles: 14
    params:
      params.yaml:
        benchmark_datasets.miniboone*: {}
        log-level: info
        seed: 1
        unconditional_benchmark_distributions.elementwise_flow.miniboone*:
          distribution_kwds:
            bijector_name: bernstein_poly
            order: 100
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
            shift: false
            scale: false
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            validation_split:
            batch_size: 87
            lr_patience: 5
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            learning_rate: 0.006797537543994487
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/mcp
      hash: md5
      md5: e35c9fba435ba06660e0f555f1fd0c8a.dir
      size: 53273
      nfiles: 3
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/metrics.yaml
      hash: md5
      md5: 37a6d282b435782aa00176a2331b6774
      size: 52
    - path: results/unconditional_benchmark_elementwise_flow_miniboone/train.log
      hash: md5
      md5: f08d60c51e7217ab9ab8b6850a9d5e6d
      size: 3628
  unconditional@elementwise_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@elementwise_flow-moons elementwise_flow moons
      results/unconditional_elementwise_flow_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.elementwise_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: 4
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.05
            lr_reduction_factor: 0.5
    outs:
    - path: results/unconditional_elementwise_flow_moons/dataset.pdf
      hash: md5
      md5: 02b032c69e810c6c0c9ae6004f41a2b4
      size: 16826
    - path: results/unconditional_elementwise_flow_moons/mcp
      hash: md5
      md5: b0a257cafb0c6baa08481b49aba25e51.dir
      size: 2862
      nfiles: 3
    - path: results/unconditional_elementwise_flow_moons/metrics.yaml
      hash: md5
      md5: e9cdde1243ea9ce8df95f69c6536a306
      size: 57
    - path: results/unconditional_elementwise_flow_moons/samples.pdf
      hash: md5
      md5: f184ffcfb28e404c47db9c9821b7c647
      size: 118463
    - path: results/unconditional_elementwise_flow_moons/train.log
      hash: md5
      md5: 8c9eab09d345de8eb585eb887e0f3737
      size: 1614
  unconditional@elementwise_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@elementwise_flow-circles elementwise_flow
      circles results/unconditional_elementwise_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.elementwise_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 80
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.005
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_elementwise_flow_circles/dataset.pdf
      hash: md5
      md5: 9e6ee1324aa330b00c9c58eb6fe67f0f
      size: 40596
    - path: results/unconditional_elementwise_flow_circles/mcp
      hash: md5
      md5: f1f6ed2441ad4bf068b0e914570a5ed4.dir
      size: 3582
      nfiles: 3
    - path: results/unconditional_elementwise_flow_circles/metrics.yaml
      hash: md5
      md5: 963d2250c078c58f2760336aca994806
      size: 57
    - path: results/unconditional_elementwise_flow_circles/samples.pdf
      hash: md5
      md5: d64dde8f2ebb971f248ff09786bcfd29
      size: 172589
    - path: results/unconditional_elementwise_flow_circles/train.log
      hash: md5
      md5: 1be215959d98ca8ef35b52f94ad19de7
      size: 1846
  unconditional@multivariate_normal-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@multivariate_normal-moons multivariate_normal
      moons results/unconditional_multivariate_normal_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_normal.moons*:
          distribution_kwds: {}
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.05
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_multivariate_normal_moons/dataset.pdf
      hash: md5
      md5: 9cd4a2203050d872883d7b5e959b7703
      size: 16826
    - path: results/unconditional_multivariate_normal_moons/mcp
      hash: md5
      md5: 3caf71e89522fe452e4666dba148c513.dir
      size: 1699
      nfiles: 3
    - path: results/unconditional_multivariate_normal_moons/metrics.yaml
      hash: md5
      md5: aa6939c3a084145ca94d171884fcec63
      size: 58
    - path: results/unconditional_multivariate_normal_moons/samples.pdf
      hash: md5
      md5: b01d50c90b65a4f420960644d4e444da
      size: 104201
    - path: results/unconditional_multivariate_normal_moons/train.log
      hash: md5
      md5: fe9fe8e804840e6a683e2d723bddf548
      size: 1575
  unconditional@multivariate_normal-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@multivariate_normal-circles multivariate_normal
      circles results/unconditional_multivariate_normal_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_normal.circles*:
          distribution_kwds: {}
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.05
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_multivariate_normal_circles/dataset.pdf
      hash: md5
      md5: 590b059ca2be69518fdaca2f8391b0eb
      size: 40596
    - path: results/unconditional_multivariate_normal_circles/mcp
      hash: md5
      md5: 0fc8a8fde8bf8a985f03c0fc21984164.dir
      size: 1699
      nfiles: 3
    - path: results/unconditional_multivariate_normal_circles/metrics.yaml
      hash: md5
      md5: 17970a578c5e62959dc43f179622d600
      size: 58
    - path: results/unconditional_multivariate_normal_circles/samples.pdf
      hash: md5
      md5: 02f4632a4db7026a462f08d9c62c7411
      size: 158354
    - path: results/unconditional_multivariate_normal_circles/train.log
      hash: md5
      md5: bd59b19d779ffa1bc515b53c37e882ac
      size: 1804
  unconditional@masked_autoregressive_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@masked_autoregressive_flow-moons masked_autoregressive_flow
      moons results/unconditional_masked_autoregressive_flow_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.masked_autoregressive_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            - 16
            activation: relu
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.05
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_masked_autoregressive_flow_moons/dataset.pdf
      hash: md5
      md5: e4b64f9c0477c079048143d51b1ffda3
      size: 16826
    - path: results/unconditional_masked_autoregressive_flow_moons/mcp
      hash: md5
      md5: 6da697f568f7b496a476c6a354726df1.dir
      size: 33033
      nfiles: 3
    - path: results/unconditional_masked_autoregressive_flow_moons/metrics.yaml
      hash: md5
      md5: c26aa6a06020d99065d220b53e7b8e72
      size: 56
    - path: results/unconditional_masked_autoregressive_flow_moons/samples.pdf
      hash: md5
      md5: 8e14fcf20c39894797b70aca14e8e5c0
      size: 126441
    - path: results/unconditional_masked_autoregressive_flow_moons/train.log
      hash: md5
      md5: 9c2601fad2156a80c4e7264522273b72
      size: 1666
  unconditional@coupling_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@coupling_flow-moons coupling_flow moons results/unconditional_coupling_flow_moons
      --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.coupling_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 2
            order: 50
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            activation: relu
            batch_norm: false
            dropout: 0
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.001
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_coupling_flow_moons/dataset.pdf
      hash: md5
      md5: 690fe84aaabc0fd54ae9a6a1779273e8
      size: 16826
    - path: results/unconditional_coupling_flow_moons/mcp
      hash: md5
      md5: 8bd1c2cf2c000bb2fd26bacb6dddef67.dir
      size: 35848
      nfiles: 3
    - path: results/unconditional_coupling_flow_moons/metrics.yaml
      hash: md5
      md5: 0698f9bd9d2ef076656a998777e49512
      size: 56
    - path: results/unconditional_coupling_flow_moons/samples.pdf
      hash: md5
      md5: b12ddc96a2b576ebb086dd2a44543bb5
      size: 124203
    - path: results/unconditional_coupling_flow_moons/train.log
      hash: md5
      md5: e8cfda2bf5df6a9602bc8de9458d3173
      size: 1669
  unconditional@multivariate_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-moons unconditional@multivariate_flow-moons multivariate_flow
      moons results/unconditional_multivariate_flow_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.005
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_multivariate_flow_moons/dataset.pdf
      hash: md5
      md5: 02b032c69e810c6c0c9ae6004f41a2b4
      size: 16826
    - path: results/unconditional_multivariate_flow_moons/mcp
      hash: md5
      md5: 45a2a271aa3049ee5f455bd8ad877a06.dir
      size: 2886
      nfiles: 3
    - path: results/unconditional_multivariate_flow_moons/metrics.yaml
      hash: md5
      md5: f4bbd10dfaf36ad91be73ab73f6726ab
      size: 56
    - path: results/unconditional_multivariate_flow_moons/samples.pdf
      hash: md5
      md5: a76e057e3eca1e90adbc4430bdd0af27
      size: 117009
    - path: results/unconditional_multivariate_flow_moons/train.log
      hash: md5
      md5: afdfc044c6b349f12c6a2c44b68c28e3
      size: 1622
  unconditional@masked_autoregressive_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@masked_autoregressive_flow-circles masked_autoregressive_flow
      circles results/unconditional_masked_autoregressive_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.masked_autoregressive_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            activation: relu
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.01
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_masked_autoregressive_flow_circles/dataset.pdf
      hash: md5
      md5: 1ec3e2ed6ca20927247c5c48b1c7063c
      size: 40596
    - path: results/unconditional_masked_autoregressive_flow_circles/mcp
      hash: md5
      md5: 71d30bcecd84d6b1ce0f6dbac32a64b5.dir
      size: 28674
      nfiles: 3
    - path: results/unconditional_masked_autoregressive_flow_circles/metrics.yaml
      hash: md5
      md5: a680d7ec0ad92349eb88fd969c188ca9
      size: 55
    - path: results/unconditional_masked_autoregressive_flow_circles/samples.pdf
      hash: md5
      md5: c22a8b4d8196ae778ff451c10f3e3b77
      size: 179592
    - path: results/unconditional_masked_autoregressive_flow_circles/train.log
      hash: md5
      md5: 69381695904f23d59da44f60532bb585
      size: 1890
  unconditional@coupling_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@coupling_flow-circles coupling_flow circles
      results/unconditional_coupling_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.coupling_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 2
            order: 50
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            activation: relu
            batch_norm: false
            dropout: 0
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.001
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_coupling_flow_circles/dataset.pdf
      hash: md5
      md5: 6fcc8e08b769e9fa423275992b779e33
      size: 40596
    - path: results/unconditional_coupling_flow_circles/mcp
      hash: md5
      md5: 132465b4d9c81a1c537ddb6ab012f185.dir
      size: 35848
      nfiles: 3
    - path: results/unconditional_coupling_flow_circles/metrics.yaml
      hash: md5
      md5: 3531feaadfdb17ba585a27e00c7a6fea
      size: 56
    - path: results/unconditional_coupling_flow_circles/samples.pdf
      hash: md5
      md5: eb61236fcd19c879b12df3d5df52104e
      size: 189777
    - path: results/unconditional_coupling_flow_circles/train.log
      hash: md5
      md5: 05c47776b7276676cb5291370d350a08
      size: 1898
  unconditional@multivariate_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-circles unconditional@multivariate_flow-circles multivariate_flow
      circles results/unconditional_multivariate_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_distributions.multivariate_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.005
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_multivariate_flow_circles/dataset.pdf
      hash: md5
      md5: f8efafb9213c1a46ec0dc8ce7ec2be7f
      size: 40596
    - path: results/unconditional_multivariate_flow_circles/mcp
      hash: md5
      md5: 1315fc158ff77ca3f3bae6d4906a6bc9.dir
      size: 2886
      nfiles: 3
    - path: results/unconditional_multivariate_flow_circles/metrics.yaml
      hash: md5
      md5: 2932660c9c3bfcfe14dbca686de32b75
      size: 58
    - path: results/unconditional_multivariate_flow_circles/samples.pdf
      hash: md5
      md5: 526dc04fd2b7e9094c3604eb659cbf35
      size: 168461
    - path: results/unconditional_multivariate_flow_circles/train.log
      hash: md5
      md5: ec73c6a83d3b79d5fafa77011e704dda
      size: 1853
  conditional@elementwise_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-circles conditional@elementwise_flow-circles elementwise_flow circles
      results/conditional_elementwise_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.elementwise_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_elementwise_flow_circles/dataset.pdf
      hash: md5
      md5: 8c603416fe51ad4f492387197b59e15d
      size: 40596
    - path: results/conditional_elementwise_flow_circles/mcp
      hash: md5
      md5: 7ec739bc66d55d76079993a65603e3d1.dir
      size: 29751
      nfiles: 3
    - path: results/conditional_elementwise_flow_circles/metrics.yaml
      hash: md5
      md5: b3d962bba07d9b18278bdef4cf71a516
      size: 55
    - path: results/conditional_elementwise_flow_circles/samples.pdf
      hash: md5
      md5: 6ead99531ebf24e71ed94b565cb05c30
      size: 169667
    - path: results/conditional_elementwise_flow_circles/train.log
      hash: md5
      md5: 0d72aeba9f1c3ab5d4aba8da8b60cb84
      size: 2484
  conditional@multivariate_normal-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-moons conditional@multivariate_normal-moons multivariate_normal
      moons results/conditional_multivariate_normal_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.multivariate_normal*:
          moons:
            distribution_kwds: {}
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds: {}
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_multivariate_normal_moons/dataset.pdf
      hash: md5
      md5: e78b4f259009dd8eeceec5a49a5d362b
      size: 16826
    - path: results/conditional_multivariate_normal_moons/mcp
      hash: md5
      md5: 964482f6f3807ea4ea94681abdb96ddb.dir
      size: 10364
      nfiles: 3
    - path: results/conditional_multivariate_normal_moons/metrics.yaml
      hash: md5
      md5: 786fc47e0b66866b80e17091adae7c68
      size: 56
    - path: results/conditional_multivariate_normal_moons/samples.pdf
      hash: md5
      md5: b6bbc9ffef445982359eae693d06af9b
      size: 106687
    - path: results/conditional_multivariate_normal_moons/train.log
      hash: md5
      md5: d0c7964fed86498930b6db5872f59395
      size: 1961
  conditional@elementwise_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-moons conditional@elementwise_flow-moons elementwise_flow moons
      results/conditional_elementwise_flow_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.elementwise_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_elementwise_flow_moons/dataset.pdf
      hash: md5
      md5: f030d157ce9aa92546a5c70768395336
      size: 16826
    - path: results/conditional_elementwise_flow_moons/mcp
      hash: md5
      md5: b82cc9b39bab5c2464aaa18b93c4a75b.dir
      size: 29751
      nfiles: 3
    - path: results/conditional_elementwise_flow_moons/metrics.yaml
      hash: md5
      md5: 915b3bb1e551903fd7157f37c655abd1
      size: 56
    - path: results/conditional_elementwise_flow_moons/samples.pdf
      hash: md5
      md5: 520685c090b435183f69bbe37baf54c3
      size: 121762
    - path: results/conditional_elementwise_flow_moons/train.log
      hash: md5
      md5: 3cfd1269c926654a51142771134fc265
      size: 2259
  conditional@multivariate_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-circles conditional@multivariate_flow-circles multivariate_flow
      circles results/conditional_multivariate_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.multivariate_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.005
              lr_reduction_factor: 0.1
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_multivariate_flow_circles/dataset.pdf
      hash: md5
      md5: 8c603416fe51ad4f492387197b59e15d
      size: 40596
    - path: results/conditional_multivariate_flow_circles/mcp
      hash: md5
      md5: f9cc0b7f8869656d763925ceb0ef277c.dir
      size: 30368
      nfiles: 3
    - path: results/conditional_multivariate_flow_circles/metrics.yaml
      hash: md5
      md5: bdf38b98edeac0a116980e6d524d0b6e
      size: 56
    - path: results/conditional_multivariate_flow_circles/samples.pdf
      hash: md5
      md5: 5a37abba5f7db8bd44303fb8ef41281a
      size: 172151
    - path: results/conditional_multivariate_flow_circles/train.log
      hash: md5
      md5: 77ec8092a85499cf708beb49db023807
      size: 2492
  conditional@multivariate_normal-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-circles conditional@multivariate_normal-circles multivariate_normal
      circles results/conditional_multivariate_normal_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.multivariate_normal*:
          moons:
            distribution_kwds: {}
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds: {}
            parameter_kwds:
              conditional: true
              activation: relu
              batch_norm: true
              dropout: 0
              hidden_units:
              - 16
              - 16
              input_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_multivariate_normal_circles/dataset.pdf
      hash: md5
      md5: 25dc2a47e3e40ae30cb7cf6a9d8faecf
      size: 40596
    - path: results/conditional_multivariate_normal_circles/mcp
      hash: md5
      md5: ef128ba7e1076cc8ff1c36ab512dd46f.dir
      size: 10364
      nfiles: 3
    - path: results/conditional_multivariate_normal_circles/metrics.yaml
      hash: md5
      md5: 7e094c3f2355dc3da4eb421d514bf230
      size: 57
    - path: results/conditional_multivariate_normal_circles/samples.pdf
      hash: md5
      md5: c8a46f10340d1196061c802ae92a3d65
      size: 155593
    - path: results/conditional_multivariate_normal_circles/train.log
      hash: md5
      md5: 2c0414adc0785964320eac3a8221e485
      size: 2189
  conditional@masked_autoregressive_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-moons conditional@masked_autoregressive_flow-moons masked_autoregressive_flow
      moons results/conditional_masked_autoregressive_flow_moons --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.masked_autoregressive_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_masked_autoregressive_flow_moons/dataset.pdf
      hash: md5
      md5: 638864755a4af8374d2d9241b36dfbd4
      size: 16826
    - path: results/conditional_masked_autoregressive_flow_moons/mcp
      hash: md5
      md5: 965368ccd92fa04dd3614ea1d709bdec.dir
      size: 37062
      nfiles: 3
    - path: results/conditional_masked_autoregressive_flow_moons/metrics.yaml
      hash: md5
      md5: c44bd8343d44304efba133e3322041b9
      size: 54
    - path: results/conditional_masked_autoregressive_flow_moons/samples.pdf
      hash: md5
      md5: b77a7597492852f5a2a7aaf4c2e8997e
      size: 127328
    - path: results/conditional_masked_autoregressive_flow_moons/train.log
      hash: md5
      md5: 93512ef8a9db32b98e20f823669e88cc
      size: 2268
  conditional@masked_autoregressive_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-circles conditional@masked_autoregressive_flow-circles masked_autoregressive_flow
      circles results/conditional_masked_autoregressive_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.masked_autoregressive_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.05
              lr_reduction_factor: 0.1
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_masked_autoregressive_flow_circles/dataset.pdf
      hash: md5
      md5: 8ce6696a4e7debb4fa06ecc2643ac871
      size: 40596
    - path: results/conditional_masked_autoregressive_flow_circles/mcp
      hash: md5
      md5: e84525d6cbbe8d4c255454367f4fa214.dir
      size: 37062
      nfiles: 3
    - path: results/conditional_masked_autoregressive_flow_circles/metrics.yaml
      hash: md5
      md5: 68a650563ca421338de672e38b0764e0
      size: 56
    - path: results/conditional_masked_autoregressive_flow_circles/samples.pdf
      hash: md5
      md5: 8f4d1f72dafe851f936e01dce2c67f4f
      size: 185264
    - path: results/conditional_masked_autoregressive_flow_circles/train.log
      hash: md5
      md5: e7001c6f72828a4ef86dac50a6a33fcf
      size: 2298
  conditional@coupling_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-moons conditional@coupling_flow-moons coupling_flow moons results/conditional_coupling_flow_moons
      --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.coupling_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              coupling_layers: 2
              order: 80
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              batch_norm: false,
              dropout: 0
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              coupling_layers: 2
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              activation: relu
              batch_norm: false,
              dropout: 0
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_coupling_flow_moons/dataset.pdf
      hash: md5
      md5: 63dface63ee4a4c5a4cb7ef8fdc70035
      size: 16826
    - path: results/conditional_coupling_flow_moons/mcp
      hash: md5
      md5: 8f248eb756b751491543ab518a4a3f0e.dir
      size: 71519
      nfiles: 3
    - path: results/conditional_coupling_flow_moons/metrics.yaml
      hash: md5
      md5: 9e205e28a8aff7e4cf3d52f32cef7e75
      size: 56
    - path: results/conditional_coupling_flow_moons/samples.pdf
      hash: md5
      md5: 482012d08c2658afc8cceccf2765c991
      size: 128240
    - path: results/conditional_coupling_flow_moons/train.log
      hash: md5
      md5: d5511e3a0a4c8f105b1a1de67a846db2
      size: 2333
  conditional@coupling_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      conditional-circles conditional@coupling_flow-circles coupling_flow circles
      results/conditional_coupling_flow_circles --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        conditional_distributions.coupling_flow*:
          moons:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              coupling_layers: 2
              order: 80
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              - 16
              activation: relu
              batch_norm: false,
              dropout: 0
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 1024
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
          circles:
            distribution_kwds:
              bijector_name: bernstein_poly
              low: -4
              high: 4
              smooth_bounds: true
              allow_flexible_bounds: false
              shift: false
              scale: false
              coupling_layers: 2
              order: 50
            parameter_kwds:
              hidden_units:
              - 16
              - 16
              activation: relu
              batch_norm: false,
              dropout: 0
              conditional: True,
              conditional_event_shape: 1
            fit_kwds:
              epochs: 10000
              batch_size: 512
              lr_patience: 100
              reduce_lr_on_plateau: true
              early_stopping: true
              verbose: true
              monitor: val_loss
              validation_split: 0.1
              learning_rate: 0.01
              lr_reduction_factor: 0.1
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
    outs:
    - path: results/conditional_coupling_flow_circles/dataset.pdf
      hash: md5
      md5: 3c3c93e4bf9e638ed19ae1b6c6d29aa3
      size: 40596
    - path: results/conditional_coupling_flow_circles/mcp
      hash: md5
      md5: 9d64856dbea38797572a386ad6510447.dir
      size: 47090
      nfiles: 3
    - path: results/conditional_coupling_flow_circles/metrics.yaml
      hash: md5
      md5: f01aa8695d3912f34229022ee782c684
      size: 55
    - path: results/conditional_coupling_flow_circles/samples.pdf
      hash: md5
      md5: eba65ea3fb9928e7a5cef16c3343c29a
      size: 195967
    - path: results/conditional_coupling_flow_circles/train.log
      hash: md5
      md5: c8272bb6e49390d895c5f1f74ffe20ca
      size: 2559
  unconditional_hybrid@masked_autoregressive_flow_first_dim_masked-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-moons unconditional_hybrid@masked_autoregressive_flow_first_dim_masked-moons
      masked_autoregressive_flow_first_dim_masked moons results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_distributions.masked_autoregressive_flow_first_dim_masked.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 25
          freeze_base_model: false
          base_checkpoint_path: false
          parameter_kwds:
            made_kwds:
              hidden_units: []
              activation: relu
            x0_kwds:
              hidden_units:
              - 32
              - 32
              activation: relu
              batch_norm: false
              dropout: 0
              kernel_initializer: glorot_uniform
              bias_initializer: zeros
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.01
            lr_reduction_factor: 0.1
    outs:
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/copula_contour.pdf
      hash: md5
      md5: ef12937f1286c7a980a6a06da2c95ab0
      size: 123270
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/copula_surface.pdf
      hash: md5
      md5: f3013e2d72ab2096493b9c41e3c3914b
      size: 875087
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/data.pdf
      hash: md5
      md5: a221720bd096163325e8e7e1b31c27f2
      size: 124513
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/dataset.pdf
      hash: md5
      md5: d1697b08f3c42805ea114dc70eddeab3
      size: 16826
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/mcp
      hash: md5
      md5: d3e32d8073035bd0182150521a61b7a1.dir
      size: 31553
      nfiles: 3
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/metrics.yaml
      hash: md5
      md5: c678f6368cc9f5e7a90f32adade1e65b
      size: 56
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/samples.pdf
      hash: md5
      md5: 84ed086566accee9ae22cb20814f7392
      size: 124128
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/train.log
      hash: md5
      md5: 869ffb59f296224273d0dc1d58a45f76
      size: 2846
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/z1.pdf
      hash: md5
      md5: 169ce6b15b8e910bf005cf242c4e9e85
      size: 110880
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_moons/z2.pdf
      hash: md5
      md5: dc31d18bfc2728ebad262ca3bee51801
      size: 85504
  unconditional_hybrid@coupling_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-moons unconditional_hybrid@coupling_flow-moons coupling_flow
      moons results/unconditional_hybrid_coupling_flow_moons/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_distributions.coupling_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 1
            order: 25
          freeze_base_model: false
          base_checkpoint_path: false
          parameter_kwds:
            hidden_units:
            - 1024
            - 1024
            - 1024
            activation: relu
            batch_norm: false
            dropout: 0
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 25
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 128
            lr_patience: 10
            reduce_lr_on_plateau: true
            early_stopping: 10
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.01
            lr_reduction_factor: 0.9
    outs:
    - path: results/unconditional_hybrid_coupling_flow_moons/copula_contour.pdf
      hash: md5
      md5: 22928b7f0dadfc83960ef62863f871f9
      size: 136003
    - path: results/unconditional_hybrid_coupling_flow_moons/copula_surface.pdf
      hash: md5
      md5: cf47bb6d881fd525b91a06be012225f5
      size: 876157
    - path: results/unconditional_hybrid_coupling_flow_moons/data.pdf
      hash: md5
      md5: 55cf3db3061233e1d1ef7c5afa564116
      size: 124894
    - path: results/unconditional_hybrid_coupling_flow_moons/dataset.pdf
      hash: md5
      md5: bdde6ddc7cca500903323ed2ac3589de
      size: 16826
    - path: results/unconditional_hybrid_coupling_flow_moons/mcp
      hash: md5
      md5: 2013062eb1392604e821f479e7122d91.dir
      size: 25529632
      nfiles: 3
    - path: results/unconditional_hybrid_coupling_flow_moons/metrics.yaml
      hash: md5
      md5: 5fe3264dd197d63148cdbe066903cee1
      size: 56
    - path: results/unconditional_hybrid_coupling_flow_moons/samples.pdf
      hash: md5
      md5: fea77853597fcab8f14a2eae2ff21acd
      size: 124480
    - path: results/unconditional_hybrid_coupling_flow_moons/train.log
      hash: md5
      md5: 2c182332823e21a0324365026e9caff6
      size: 2616
    - path: results/unconditional_hybrid_coupling_flow_moons/z1.pdf
      hash: md5
      md5: 79112f29ef49f9ece53de3f4fbac8a10
      size: 104995
    - path: results/unconditional_hybrid_coupling_flow_moons/z2.pdf
      hash: md5
      md5: 289ec7caa57e22b02f3c6838c0572926
      size: 83511
  unconditional_hybrid@coupling_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-circles unconditional_hybrid@coupling_flow-circles coupling_flow
      circles results/unconditional_hybrid_coupling_flow_circles/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_distributions.coupling_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 1
            order: 80
          freeze_base_model: false
          base_checkpoint_path: false
          parameter_kwds:
            hidden_units:
            - 512
            - 512
            activation: relu
            batch_norm: false
            dropout: 0
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 25
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.005
            lr_reduction_factor: 0.1
    outs:
    - path: results/unconditional_hybrid_coupling_flow_circles/copula_contour.pdf
      hash: md5
      md5: 553dba20d0eb400cecbd8025ef88efdf
      size: 192837
    - path: results/unconditional_hybrid_coupling_flow_circles/copula_surface.pdf
      hash: md5
      md5: b47825ff994016dd94355bb98b5ffee7
      size: 918702
    - path: results/unconditional_hybrid_coupling_flow_circles/data.pdf
      hash: md5
      md5: 6fa11878a16c0e6ce641863afd3c05ec
      size: 186704
    - path: results/unconditional_hybrid_coupling_flow_circles/dataset.pdf
      hash: md5
      md5: 4182ddddbbe73f5c48fcf24b95ad4d79
      size: 40596
    - path: results/unconditional_hybrid_coupling_flow_circles/mcp
      hash: md5
      md5: ca3c3f557d629a3fe813ae45b5d55efa.dir
      size: 3662582
      nfiles: 3
    - path: results/unconditional_hybrid_coupling_flow_circles/metrics.yaml
      hash: md5
      md5: f459370411ba711202d4facab9191d0d
      size: 54
    - path: results/unconditional_hybrid_coupling_flow_circles/samples.pdf
      hash: md5
      md5: 392467f6b22148dd8a8e42e2f828e6dd
      size: 164668
    - path: results/unconditional_hybrid_coupling_flow_circles/train.log
      hash: md5
      md5: 49d35e2b8e0676f8bb16e083bb456203
      size: 2643
    - path: results/unconditional_hybrid_coupling_flow_circles/z1.pdf
      hash: md5
      md5: 27201413620eba066506fd40c39d95ff
      size: 152847
    - path: results/unconditional_hybrid_coupling_flow_circles/z2.pdf
      hash: md5
      md5: 4d343d9e1eb0258457fff91fe1207e51
      size: 126147
  unconditional_hybrid@masked_autoregressive_flow_first_dim_masked-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-circles unconditional_hybrid@masked_autoregressive_flow_first_dim_masked-circles
      masked_autoregressive_flow_first_dim_masked circles
      results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_distributions.masked_autoregressive_flow_first_dim_masked.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 100
          freeze_base_model: false
          base_checkpoint_path: false
          parameter_kwds:
            made_kwds:
              hidden_units: []
              activation: relu
            x0_kwds:
              hidden_units:
              - 16
              - 16
              activation: relu
              batch_norm: false
              dropout: 0
              kernel_initializer: glorot_uniform
              bias_initializer: zeros
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 80
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 500
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.01
            lr_reduction_factor: 0.1
    outs:
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/copula_contour.pdf
      hash: md5
      md5: 6d589e0121d32f4caac9a1a25bd53df6
      size: 172964
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/copula_surface.pdf
      hash: md5
      md5: a3611786431f9d6c048d13f6149fbd4b
      size: 892218
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/data.pdf
      hash: md5
      md5: 081d694ff4469174f8871cf8c35e96b0
      size: 188017
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/dataset.pdf
      hash: md5
      md5: 81f98bad7c397517523781907ab1482c
      size: 40596
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/mcp
      hash: md5
      md5: ab8387e62c52deeffdde0e687e657c7f.dir
      size: 34781
      nfiles: 3
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/metrics.yaml
      hash: md5
      md5: b27096364d71e88959f4b5a262522ae6
      size: 55
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/samples.pdf
      hash: md5
      md5: 79d329e5d0090005fb72a8ba7bfe5bf3
      size: 185630
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/train.log
      hash: md5
      md5: c9bcd5d8c93fd0596efb717cde8ed3c1
      size: 3077
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/z1.pdf
      hash: md5
      md5: 54b0b8a3050c51717027ae0d7559bb6d
      size: 161456
    - path:
        results/unconditional_hybrid_masked_autoregressive_flow_first_dim_masked_circles/z2.pdf
      hash: md5
      md5: 6a5dee1ebae226d4c247259625bba03f
      size: 125141
  unconditional_hybrid_pre_trained@coupling_flow-moons:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-pre-trained-moons unconditional_hybrid_pre_trained@coupling_flow-moons
      coupling_flow moons results/unconditional_hybrid_pre_trained_coupling_flow_moons/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: results/unconditional_elementwise_flow_moons/mcp
      hash: md5
      md5: b0a257cafb0c6baa08481b49aba25e51.dir
      size: 2862
      nfiles: 3
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.moons*:
          n_samples: 500
          noise: 0.05
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_pre_trained_distributions.coupling_flow.moons*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 1
            order: 50
          freeze_base_model: true
          base_checkpoint_path: unconditional_elementwise_flow_moons/mcp/weights
          parameter_kwds:
            hidden_units:
            - 16
            - 512
            activation: sigmoid
            batch_norm: false
            dropout: 0
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 50
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 512
            lr_patience: 25
            reduce_lr_on_plateau: true
            early_stopping: 5
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.01
            lr_reduction_factor: 0.8
    outs:
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/copula_contour.pdf
      hash: md5
      md5: ed59d001bc3733d8c0a4f9196950b1e6
      size: 155803
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/copula_surface.pdf
      hash: md5
      md5: 2adeb87e6569f90763dfab39118aa887
      size: 872373
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/data.pdf
      hash: md5
      md5: 8d99d12cf730a73d0aa585bb504e881e
      size: 125563
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/dataset.pdf
      hash: md5
      md5: f70a8cc69f6bfb4f996d31492f7f3107
      size: 16826
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/mcp
      hash: md5
      md5: 399b2a9eddffc3d0c4568f417eadf294.dir
      size: 417965
      nfiles: 3
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/metrics.yaml
      hash: md5
      md5: be9b63d8ef99d580b181e30713b11e60
      size: 56
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/samples.pdf
      hash: md5
      md5: e806a7c29553d701b726f402fd231e21
      size: 124983
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/train.log
      hash: md5
      md5: d11e7521610749ad192ce02f3c6e6214
      size: 2159
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/z1.pdf
      hash: md5
      md5: 0771743665b5aa99ddd7b5a70f38fe2e
      size: 106572
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_moons/z2.pdf
      hash: md5
      md5: 6e15d0ea72dd0e4e3a046a7f0d93b19f
      size: 81419
  unconditional_hybrid_pre_trained@coupling_flow-circles:
    cmd: python scripts/train.py --log-level info --log-file train.log --experiment-name
      unconditional-hybrid-pre-trained-circles unconditional_hybrid_pre_trained@coupling_flow-circles
      coupling_flow circles results/unconditional_hybrid_pre_trained_coupling_flow_circles/  --test-mode=false
    deps:
    - path: pyproject.toml
      hash: md5
      md5: 74ebc50ae74891f977f148586664274b
      size: 1203
    - path: results/unconditional_elementwise_flow_circles/mcp
      hash: md5
      md5: f1f6ed2441ad4bf068b0e914570a5ed4.dir
      size: 3582
      nfiles: 3
    - path: scripts/train.py
      hash: md5
      md5: 25cd330e4208237ccb67c87f3bf78911
      size: 5361
    - path: src/mctm
      hash: md5
      md5: 32f9fe9bf5bc1053a4973c7b160ee859.dir
      size: 85328
      nfiles: 15
    params:
      params.yaml:
        datasets.circles*:
          n_samples: 2000
          noise: 0.05
          factor: 0.5
          scale:
          - 0.05
          - 0.95
        log-level: info
        seed: 1
        textwidth: 487.8225
        unconditional_hybrid_pre_trained_distributions.coupling_flow.circles*:
          distribution_kwds:
            bijector_name: bernstein_poly
            low: 0
            high: 1
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            coupling_layers: 1
            order: 80
          freeze_base_model: true
          base_checkpoint_path: unconditional_elementwise_flow_circles/mcp/weights
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            - 16
            activation: relu
            batch_norm: false
            dropout: 0
          base_distribution: elementwise_flow
          base_distribution_kwds:
            bijector_name: bernstein_poly
            low: -4
            high: 4
            smooth_bounds: true
            allow_flexible_bounds: false
            shift: false
            scale: false
            order: 80
          base_parameter_kwds:
            conditional: false
            dtype: float32
          fit_kwds:
            epochs: 10000
            batch_size: 1024
            lr_patience: 100
            reduce_lr_on_plateau: true
            early_stopping: true
            verbose: true
            monitor: val_loss
            validation_split: 0.1
            learning_rate: 0.005
            lr_reduction_factor: 0.1
    outs:
    - path:
        results/unconditional_hybrid_pre_trained_coupling_flow_circles/copula_contour.pdf
      hash: md5
      md5: 33d9fd4d61a42d6a9b71530a3ba24c8a
      size: 184265
    - path:
        results/unconditional_hybrid_pre_trained_coupling_flow_circles/copula_surface.pdf
      hash: md5
      md5: ff093b71109c1851b1a179e55cf42624
      size: 911204
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/data.pdf
      hash: md5
      md5: f663bbb9d1a638015d53a6e63dd62915
      size: 185191
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/dataset.pdf
      hash: md5
      md5: 879606ca6f5351c7bcf977f6779a3f78
      size: 40596
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/mcp
      hash: md5
      md5: 6029dbf2da3712e853163540114c65ba.dir
      size: 29924
      nfiles: 3
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/metrics.yaml
      hash: md5
      md5: ccb0c672119747775f16f819f3c002e7
      size: 56
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/samples.pdf
      hash: md5
      md5: ad7b71e59a22d7e37b8ecd89ee4adb9b
      size: 164245
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/train.log
      hash: md5
      md5: ae3149965d13a3087faf697ca7a74810
      size: 2394
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/z1.pdf
      hash: md5
      md5: 0cb71991d75ae44dd9c1197f1d1a21f2
      size: 156751
    - path: results/unconditional_hybrid_pre_trained_coupling_flow_circles/z2.pdf
      hash: md5
      md5: dce15eaeec4ed3ec2b7b0e9fd1e504c4
      size: 125200
