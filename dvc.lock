schema: '2.0'
stages:
  train@bernstein_flow:
    cmd: python scripts/multivariate_unconditional.py --log-level info --log-file
      train_bernstein_flow.log --experiment-name unconditional-moons train@bernstein_flow
      results/bernstein_flow
    deps:
    - path: scripts/multivariate_unconditional.py
      hash: md5
      md5: f386cc32aca768c92418859630b74cff
      size: 4001
    params:
      params.yaml:
        common.data_kwds:
          n_samples: 2000
          noise: 0.05
          scale: true
        common.dataset: moons
        common.seed: 1
        distributions.bernstein_flow:
          distribution_kwds: &id001
            order: 25
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
          fit_kwds: &id002
            epochs: 1000
            validation_split: 0.1
            batch_size: 32
            learning_rate: 0.001
            lr_patience: 10
        distributions.bernstein_flow.distribution_kwds: *id001
        distributions.bernstein_flow.fit_kwds: *id002
    outs:
    - path: results/bernstein_flow/metrics.yaml
      hash: md5
      md5: d3b51c1656029c5dc8c342897ad69555
      size: 57
  train@multivariate_bernstein_flow:
    cmd: python scripts/multivariate_unconditional.py --log-level info --log-file
      train_multivariate_bernstein_flow.log --experiment-name unconditional-moons
      train@multivariate_bernstein_flow results/multivariate_bernstein_flow
    deps:
    - path: scripts/multivariate_unconditional.py
      hash: md5
      md5: f386cc32aca768c92418859630b74cff
      size: 4001
    params:
      params.yaml:
        common.data_kwds:
          n_samples: 2000
          noise: 0.05
          scale: true
        common.dataset: moons
        common.seed: 1
        distributions.multivariate_bernstein_flow:
          distribution_kwds: &id003
            order: 25
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
          fit_kwds: &id004
            epochs: 1000
            validation_split: 0.1
            batch_size: 32
            learning_rate: 0.001
            lr_patience: 10
        distributions.multivariate_bernstein_flow.distribution_kwds: *id003
        distributions.multivariate_bernstein_flow.fit_kwds: *id004
    outs:
    - path: results/multivariate_bernstein_flow/metrics.yaml
      hash: md5
      md5: e90ea06dbe615305e2df912bbc9abbbb
      size: 58
  train@multivariate_normal:
    cmd: python scripts/multivariate_unconditional.py --log-level info --log-file
      train_multivariate_normal.log --experiment-name unconditional-moons train@multivariate_normal
      results/multivariate_normal
    deps:
    - path: scripts/multivariate_unconditional.py
      hash: md5
      md5: f386cc32aca768c92418859630b74cff
      size: 4001
    params:
      params.yaml:
        common.data_kwds:
          n_samples: 2000
          noise: 0.05
          scale: true
        common.dataset: moons
        common.seed: 1
        distributions.multivariate_normal:
          distribution_kwds: &id005 {}
          fit_kwds: &id006
            epochs: 1000
            validation_split: 0.1
            batch_size: 32
            learning_rate: 0.001
            lr_patience: 10
        distributions.multivariate_normal.distribution_kwds: *id005
        distributions.multivariate_normal.fit_kwds: *id006
    outs:
    - path: results/multivariate_normal/metrics.yaml
      hash: md5
      md5: 4aa46ad1b617ea9be3d690a39e735db7
      size: 53
  train@masked_autoregressive_bernstein_flow:
    cmd: python scripts/multivariate_unconditional.py --log-level info --log-file
      train_masked_autoregressive_bernstein_flow.log --experiment-name unconditional-moons
      train@masked_autoregressive_bernstein_flow results/masked_autoregressive_bernstein_flow
    deps:
    - path: scripts/multivariate_unconditional.py
      hash: md5
      md5: d1460d9baf3fcc112941dfd2b9eddd8c
      size: 4062
    params:
      params.yaml:
        common.data_kwds:
          n_samples: 2000
          noise: 0.05
          scale: true
        common.dataset: moons
        common.seed: 1
        distributions.masked_autoregressive_bernstein_flow:
          distribution_kwds: &id007
            order: 25
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            activation: relu
          fit_kwds: &id008
            epochs: 1000
            validation_split: 0.1
            batch_size: 32
            learning_rate: 0.001
            lr_patience: 10
        distributions.masked_autoregressive_bernstein_flow.distribution_kwds: *id007
        distributions.masked_autoregressive_bernstein_flow.fit_kwds: *id008
    outs:
    - path: results/masked_autoregressive_bernstein_flow/metrics.yaml
      hash: md5
      md5: ae9290253df9d8e1a7797cb31d68ba4e
      size: 56
  train@coupling_bernstein_flow:
    cmd: python scripts/multivariate_unconditional.py --log-level info --log-file
      train_coupling_bernstein_flow.log --experiment-name unconditional-moons train@coupling_bernstein_flow
      results/coupling_bernstein_flow
    deps:
    - path: scripts/multivariate_unconditional.py
      hash: md5
      md5: d1460d9baf3fcc112941dfd2b9eddd8c
      size: 4062
    params:
      params.yaml:
        common.data_kwds:
          n_samples: 2000
          noise: 0.05
          scale: true
        common.dataset: moons
        common.seed: 1
        distributions.coupling_bernstein_flow:
          distribution_kwds: &id009
            order: 25
            low: -3
            high: 3
            smooth_bounds: true
            allow_flexible_bounds: true
            coupling_layers: 2
          parameter_kwds:
            hidden_units:
            - 16
            - 16
            activation: relu
            batch_norm: false,
          fit_kwds: &id010
            epochs: 1000
            validation_split: 0.1
            batch_size: 32
            learning_rate: 0.001
            lr_patience: 10
        distributions.coupling_bernstein_flow.distribution_kwds: *id009
        distributions.coupling_bernstein_flow.fit_kwds: *id010
    outs:
    - path: results/coupling_bernstein_flow/metrics.yaml
      hash: md5
      md5: b6f315af2169d83bc7fac09107e1bfb4
      size: 56
