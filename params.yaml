log-level: info
seed: 1
textwidth: 487.8225
testmode: true

datasets:
  moons:
    n_samples: 2000
    noise: 0.05
    scale: true
  circles:
    n_samples: 2000
    noise: 0.05
    factor: 0.5
    scale: true

benchmark_datasets:
  BSDS300:
    shift:
      - 0.7783153653144836
      - 0.7590853571891785
      - 0.7645905017852783
      - 0.707426130771637
      - 0.6945772171020508
      - 0.6677097082138062
      - 0.7841058373451233
      - 0.8033101558685303
      - 0.7123053669929504
      - 0.6456467509269714
      - 0.6919570565223694
      - 0.7075815200805664
      - 0.5881405472755432
      - 0.6687179207801819
      - 0.6634955406188965
      - 0.6950870156288147
      - 0.7188506126403809
      - 0.6791635155677795
      - 0.5913376212120056
      - 0.605964183807373
      - 0.5914243459701538
      - 0.6460529565811157
      - 0.6267989873886108
      - 0.7205476760864258
      - 0.7674960494041443
      - 0.5769509673118591
      - 0.5536211133003235
      - 0.5901206135749817
      - 0.5569162368774414
      - 0.5691400170326233
      - 0.5574676394462585
      - 0.6855510473251343
      - 0.6601111888885498
      - 0.6125123500823975
      - 0.6403083801269531
      - 0.5965210795402527
      - 0.624169111251831
      - 0.5519786477088928
      - 0.6087561249732971
      - 0.6934596300125122
      - 0.6747593283653259
      - 0.6044197678565979
      - 0.6022863388061523
      - 0.6196379661560059
      - 0.6343846321105957
      - 0.6711614727973938
      - 0.6469463109970093
      - 0.7107809782028198
      - 0.6664911508560181
      - 0.6064401865005493
      - 0.5887945294380188
      - 0.6200698614120483
      - 0.6031097173690796
      - 0.6111871600151062
      - 0.6019214391708374
      - 0.6552285552024841
      - 0.7080591320991516
      - 0.6441200971603394
      - 0.6454378366470337
      - 0.7034891247749329
      - 0.6425648927688599
      - 0.6379201412200928
      - 0.7260892987251282

    scale:
      - 0.6249821782112122
      - 0.6416864395141602
      - 0.649444580078125
      - 0.6756175756454468
      - 0.6822690367698669
      - 0.7010855674743652
      - 0.6482590436935425
      - 0.624426543712616
      - 0.636197030544281
      - 0.7212271094322205
      - 0.7104126811027527
      - 0.6823146343231201
      - 0.7462795972824097
      - 0.7050884366035461
      - 0.7101330757141113
      - 0.6728689670562744
      - 0.6564426422119141
      - 0.69979327917099
      - 0.690335214138031
      - 0.7053917646408081
      - 0.7183295488357544
      - 0.7222234606742859
      - 0.7302163243293762
      - 0.666165292263031
      - 0.6215938925743103
      - 0.7226759195327759
      - 0.7648634910583496
      - 0.7497854232788086
      - 0.7473996877670288
      - 0.7566871047019958
      - 0.7548065781593323
      - 0.6757977604866028
      - 0.7031866312026978
      - 0.712154746055603
      - 0.7207444906234741
      - 0.7169550657272339
      - 0.7540625929832458
      - 0.7606439590454102
      - 0.730010449886322
      - 0.6474512815475464
      - 0.6757168173789978
      - 0.7092487215995789
      - 0.7590519785881042
      - 0.741417646408081
      - 0.7130131125450134
      - 0.697540819644928
      - 0.7025668025016785
      - 0.6570675373077393
      - 0.7043712735176086
      - 0.7324617505073547
      - 0.765039324760437
      - 0.7218276262283325
      - 0.7608193755149841
      - 0.7506404519081116
      - 0.7069103717803955
      - 0.6903284192085266
      - 0.614315927028656
      - 0.6559529304504395
      - 0.6605854034423828
      - 0.6487672924995422
      - 0.6754842400550842
      - 0.6749744415283203
      - 0.6471037864685059
  HEPMASS:
    scale:
    - 0.17695256134575785
    - 0.19759763329826005
    - 0.28867610590127607
    - 0.09253009925936441
    - 0.28890113221680425
    - 0.10123199587499439
    - 0.16401727890530876
    - 0.2889207570651296
    - 0.11516967277054968
    - 0.1825951488793211
    - 0.2886355332187824
    - 0.13255015613375584
    - 0.1982244246817454
    - 0.2888247800146859
    - 0.15848495145654218
    - 0.21733771406591254
    - 0.2885888039361186
    - 0.1116598268134329
    - 0.09219991272958859
    - 0.06295419885822616
    - 0.15128297907738794
    shift:
    - 2.265399710654582
    - 2.531844790110442
    - 1.7344418954418521
    - 8.052965511466715
    - 1.7312062399185746
    - 5.183422296298865
    - 3.04936281305711
    - 1.7301672342402206
    - 4.134827306214499
    - 2.7372062075764245
    - 1.7314321828801922
    - 3.152846983050629
    - 2.5223740920735453
    - 1.7321641839195632
    - 2.0002168167956955
    - 2.3020041453145943
    - 1.7322310449074751
    - 3.0708844573320158
    - 3.4145194665742595
    - 5.92790623307369
    - 2.5212808189161477
  MINIBOONE:
    scale:
    - 0.10334264244515758
    - 0.10621536003105092
    - 0.0682334223653949
    - 0.07346789810626338
    - 0.08015583223749585
    - 0.11139291237282614
    - 0.11137769609453001
    - 0.09767107927063683
    - 0.09158914536092244
    - 0.06036509544001272
    - 0.22175244933118657
    - 0.24952927184103696
    - 0.08990903662374682
    - 0.143232340833376
    - 0.14922175472487428
    - 0.031229718076870187
    - 0.0846261105041304
    - 0.07771330430745081
    - 0.04171520674718831
    - 0.0822227667584418
    - 0.06536778057922817
    - 0.0554866268274607
    - 0.0359185392724435
    - 0.08480965592394947
    - 0.06841137854164227
    - 0.07095308610924138
    - 0.08776599248684097
    - 0.08388107452489374
    - 0.0933558489686088
    - 0.1988073693896371
    - 0.11705505041731322
    - 0.09819440090128163
    - 0.1074961118010386
    - 0.06177303810289645
    - 0.06888390673336123
    - 0.12655067692819513
    - 0.057103806646637605
    - 0.052921306226952444
    - 0.05055431735696499
    - 0.04016329086096863
    - 0.08863616149690565
    - 0.037506513671035704
    - 0.09125131199675945
    shift:
    - 2.4480202524577432
    - 1.1862689759338267
    - 0.4761170406463332
    - 3.9758084478983857
    - 1.483343235545288
    - 3.2026944652243428
    - 6.521560572642641
    - 4.45843711126435
    - 3.1616131368675218
    - 6.282306115439889
    - 1.3440977382497974
    - 3.090414521893262
    - 1.848094473912557
    - 1.4390619235771342
    - 1.4213604382214784
    - 0.5953487734331023
    - 4.028298976002369
    - 6.401772340919938
    - 11.054928029524982
    - 6.684901549695364
    - 2.267296215624182
    - 17.087081293014844
    - 23.49715981363247
    - 2.8817025039267605
    - 3.5646294632475954
    - 5.427871366740003
    - 2.222479285589368
    - 7.009436868749215
    - 1.4204062188184656
    - 3.6053345483105725
    - 3.3439575168600957
    - 2.460961275233751
    - 5.5115807119579765
    - 3.681519143381214
    - 3.243660065814275
    - 3.191308057347147
    - 11.384808779434902
    - 1.8951547161872462
    - 1.6773052225567346
    - 21.009729813052733
    - 1.8432593017316876
    - 7.0422226399138195
    - 5.296240295168592
  POWER:
    scale:
    - 0.09568583419588816
    - 0.1046697071863797
    - 0.06917016831239553
    - 0.07215392605459134
    - 0.26385889573217364
    - 0.28881530661915067
    shift:
    - 0.9607775340084271
    - 5.445887760615095
    - 0.2633235161191925
    - 0.3085445219533287
    - 0.8240348750373009
    - 1.7315114778178926

unconditional_distributions:
  bernstein_flow:
    moons:
      distribution_kwds: &distribution_kwds
        order: 50
        low: -3
        high: 3
        smooth_bounds: true
        allow_flexible_bounds: true
        shift: false
        scale: false
        clip_to_bernstein_domain: false
        # base_distribution_kwds:
        #   distribution_type: uniform
        # base_distribution_kwds:
        #   distribution_type: kumaraswamy
        #   concentration1: 2
        #   concentration0: 5
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  multivariate_bernstein_flow:
    moons:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  multivariate_normal:
    moons:
      distribution_kwds: {}
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: {}
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  masked_autoregressive_bernstein_flow:
    moons:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  coupling_bernstein_flow:
    moons:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 2
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 2
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

unconditional_benchmark_distributions:
  bernstein_flow:
    POWER:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 25
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    HEPMASS:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 25
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    MINIBOONE:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 25
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    BSDS300:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
      parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.0001
        lr_patience: 25
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  # multivariate_bernstein_flow:
  #   POWER:
  #     distribution_kwds: *distribution_kwds
  #     parameter_kwds:
  #       conditional: false
  #       dtype: float32
  #     fit_kwds:
  #       epochs: 10000
  #       validation_split: 0.1
  #       batch_size: 512
  #       learning_rate: 0.01
  #       lr_patience: 50
  #       reduce_lr_on_plateau: true
  #       early_stopping: true
  #       verbose: true
  #       monitor: val_loss
  #   HEPMASS:
  #     distribution_kwds: *distribution_kwds
  #     parameter_kwds:
  #       conditional: false
  #       dtype: float32
  #     fit_kwds:
  #       epochs: 10000
  #       validation_split: 0.1
  #       batch_size: 512
  #       learning_rate: 0.01
  #       lr_patience: 50
  #       reduce_lr_on_plateau: true
  #       early_stopping: true
  #       verbose: true
  #       monitor: val_loss
  #   MINIBOONE:
  #     distribution_kwds: *distribution_kwds
  #     parameter_kwds:
  #       conditional: false
  #       dtype: float32
  #     fit_kwds:
  #       epochs: 10000
  #       validation_split: 0.1
  #       batch_size: 512
  #       learning_rate: 0.01
  #       lr_patience: 50
  #       reduce_lr_on_plateau: true
  #       early_stopping: true
  #       verbose: true
  #       monitor: val_loss
  #   BSDS300:
  #     distribution_kwds: *distribution_kwds
  #     parameter_kwds:
  #       conditional: false
  #       dtype: float32
  #     fit_kwds:
  #       epochs: 10000
  #       validation_split: 0.1
  #       batch_size: 512
  #       learning_rate: 0.01
  #       lr_patience: 50
  #       reduce_lr_on_plateau: true
  #       early_stopping: true
  #       verbose: true
  #       monitor: val_loss

  masked_autoregressive_bernstein_flow:
    POWER:
      distribution_kwds: &benchmark_distribution_kwds
        <<: *distribution_kwds
        order: 100
        base_distribution_kwds:
          distribution_type: kumaraswamy
          concentration1: 2
          concentration0: 5
        low: 0.001
        high: 0.999
        smooth_bounds: true
        allow_flexible_bounds: false
      parameter_kwds:
        hidden_units:
        - 256
        - 256
        - 256
        activation: relu
      fit_kwds:
        epochs: 10000
        batch_size: 1024
        learning_rate: 0.01
        lr_patience: 5
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    HEPMASS:
      distribution_kwds: *benchmark_distribution_kwds
      parameter_kwds:
        hidden_units:
        - 256
        - 256
        - 256
        activation: relu
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 10
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    BSDS300:
      distribution_kwds: *benchmark_distribution_kwds
      parameter_kwds:
        hidden_units:
        - 128
        - 128
        - 128
        activation: relu
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 15
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    MINIBOONE:
      distribution_kwds: *benchmark_distribution_kwds
      parameter_kwds:
        hidden_units:
        - 256
        - 256
        - 256
        activation: relu
      fit_kwds:
        epochs: 10000
        batch_size: 512
        learning_rate: 0.005
        lr_patience: 15
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

conditional_distributions:
  bernstein_flow:
    moons:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  multivariate_bernstein_flow:
    moons:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  multivariate_normal:
    moons:
      distribution_kwds: {}
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: {}
      parameter_kwds:
        conditional: true
        activation: relu
        batch_norm: true
        hidden_units:
        - 16
        - 16
        input_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  masked_autoregressive_bernstein_flow:
    moons:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        conditional: True,
        # conditional_input_layers='first_layer',
        conditional_event_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds: *distribution_kwds
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        conditional: True,
        # conditional_input_layers='first_layer',
        conditional_event_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  coupling_bernstein_flow:
    moons:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 2
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false,
        conditional: True,
        conditional_event_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 2
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false,
        conditional: True,
        conditional_event_shape: 1
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.001
        lr_patience: 100
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

unconditional_hybrid_distributions:
  masked_autoregressive_bernstein_flow_first_dim_masked:
    moons:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
        low: 0
        high: 1
      freeze_base_model: false
      base_checkpoint_path: false
      parameter_kwds:
        made_kwds:
          hidden_units: []
          activation: relu
        x0_kwds:
          hidden_units:
          - 16
          - 16
          activation: relu
          batch_norm: false
          kernel_initializer: glorot_uniform
          bias_initializer: zeros
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds:
        <<: *distribution_kwds
        order: 100
        low: 0
        high: 1
      freeze_base_model: false
      base_checkpoint_path: false
      parameter_kwds:
        made_kwds:
          hidden_units: []
          activation: relu
        x0_kwds:
          hidden_units:
          - 16
          - 16
          activation: relu
          batch_norm: false
          kernel_initializer: glorot_uniform
          bias_initializer: zeros
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

  coupling_bernstein_flow:
    moons:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 1
        order: 100
        low: 0
        high: 1
      freeze_base_model: false
      base_checkpoint_path: false
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 1
        order: 100
        low: 0
        high: 1
      freeze_base_model: false
      base_checkpoint_path: false
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss

unconditional_hybrid_pre_trained_distributions:
  # masked_autoregressive_bernstein_flow:
  #   distribution_kwds: *distribution_kwds
  #   freeze_base_model: true
  #   base_checkpoint_path: unconditional_bernstein_flow
  #   parameter_kwds:
  #     hidden_units:
  #     - 16
  #     - 16
  #     activation: relu
  #   base_distribution: bernstein_flow
  #   base_distribution_kwds: *distribution_kwds
  #   base_parameter_kwds:
  #     conditional: false
  #     dtype: float32
  #   fit_kwds:
  #     epochs: 10000
  #     validation_split: 0.1
  #     batch_size: 512
  #     learning_rate: 0.01
  #     lr_patience: 500
  #     reduce_lr_on_plateau: true
  #     early_stopping: true
  #     verbose: true
  #     monitor: val_loss

  coupling_bernstein_flow:
    moons:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 1
        order: 100
        low: 0
        high: 1
      freeze_base_model: true
      base_checkpoint_path: unconditional_bernstein_flow
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
    circles:
      distribution_kwds:
        <<: *distribution_kwds
        coupling_layers: 1
        order: 100
        low: 0
        high: 1
      freeze_base_model: true
      base_checkpoint_path: unconditional_bernstein_flow
      parameter_kwds:
        hidden_units:
        - 16
        - 16
        activation: relu
        batch_norm: false
      base_distribution: bernstein_flow
      base_distribution_kwds: *distribution_kwds
      base_parameter_kwds:
        conditional: false
        dtype: float32
      fit_kwds:
        epochs: 10000
        validation_split: 0.1
        batch_size: 512
        learning_rate: 0.01
        lr_patience: 500
        reduce_lr_on_plateau: true
        early_stopping: true
        verbose: true
        monitor: val_loss
